!function e(t,i,n){function a(r,s){if(!i[r]){if(!t[r]){var l="function"==typeof require&&require;if(!s&&l)return l(r,!0);if(o)return o(r,!0);var u=new Error("Cannot find module '"+r+"'");throw u.code="MODULE_NOT_FOUND",u}var c=i[r]={exports:{}};t[r][0].call(c.exports,function(e){var i=t[r][1][e];return a(i||e)},c,c.exports,e,t,i,n)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)a(n[r]);return a}({1:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("./pieces.js"),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(n);i.default={pieces:a.default}},{"./pieces.js":2}],2:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.default={frames:{blue:{frame:{x:152,y:1,w:151,h:161},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:151,h:161},sourceSize:{w:151,h:161}},blue_p:{frame:{x:156,y:164,w:151,h:161},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:151,h:161},sourceSize:{w:151,h:161}},donut:{frame:{x:609,y:164,w:181,h:149},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:181,h:149},sourceSize:{w:181,h:149}},green:{frame:{x:460,y:327,w:149,h:161},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:149,h:161},sourceSize:{w:149,h:161}},macaron:{frame:{x:610,y:1,w:148,h:155},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:148,h:155},sourceSize:{w:148,h:155}},marshmallow:{frame:{x:305,y:1,w:151,h:161},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:151,h:161},sourceSize:{w:151,h:161}},orange:{frame:{x:156,y:327,w:150,h:161},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:150,h:161},sourceSize:{w:150,h:161}},orange_p:{frame:{x:308,y:327,w:150,h:161},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:150,h:161},sourceSize:{w:150,h:161}},popcorn:{frame:{x:461,y:164,w:146,h:161},rotated:!1,trimmed:!0,spriteSourceSize:{x:2,y:0,w:146,h:161},sourceSize:{w:151,h:161}},pudding:{frame:{x:611,y:315,w:159,h:153},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:159,h:153},sourceSize:{w:159,h:153}},purple:{frame:{x:1,y:165,w:153,h:161},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:153,h:161},sourceSize:{w:153,h:161}},purple_p:{frame:{x:1,y:328,w:153,h:161},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:153,h:161},sourceSize:{w:153,h:161}},red:{frame:{x:309,y:164,w:150,h:161},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:150,h:161},sourceSize:{w:150,h:161}},red_p:{frame:{x:458,y:1,w:150,h:161},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:150,h:161},sourceSize:{w:150,h:161}},yellow:{frame:{x:1,y:1,w:149,h:162},rotated:!1,trimmed:!1,spriteSourceSize:{x:0,y:0,w:149,h:162},sourceSize:{w:149,h:162}}},meta:{app:"http://www.codeandweb.com/texturepacker",version:"1.0",image:"tiles.png",format:"RGBA8888",size:{w:791,h:490},scale:"1",smartupdate:"$TexturePacker:SmartUpdate:a52266418105fd394661db76f76d6094:5da80af01517e173c5b36dd3086b03ba:accbe1e7e294ded8391337fc1c446319$"}}},{}],3:[function(e,t,i){"use strict";function n(e,t){var i=this;i.DIRECTION_UP=1,i.DIRECTION_DOWN=2,i.DIRECTION_LEFT=4,i.DIRECTION_RIGHT=8,i.DIRECTION_UP_RIGHT=16,i.DIRECTION_UP_LEFT=32,i.DIRECTION_DOWN_RIGHT=64,i.DIRECTION_DOWN_LEFT=128,i.game=e,i.model=void 0!==t?t:null,i.dragLength=100,i.diagonalDelta=50,i.swiping=!1,i.direction=null,i.tmpDirection=null,i.tmpCallback=null,i.diagonalDisabled=!1,this.game.input.onDown.add(function(){i.swiping=!0}),this.game.input.onUp.add(function(){i.swiping=!1})}n.prototype.keyUp=function(){this.direction=this.tmpDirection,this.tmpDirection=null,null!==this.tmpCallback&&(this.tmpCallback.call(this.model),this.tmpCallback=null)},n.prototype.check=function(){if(null!==this.direction){var e={x:0,y:0,direction:this.direction};return this.direction=null,e}if(!this.swiping)return null;if(Phaser.Point.distance(this.game.input.activePointer.position,this.game.input.activePointer.positionDown)<this.dragLength)return null;this.swiping=!1;var t=null,i=this.game.input.activePointer.position.x-this.game.input.activePointer.positionDown.x,n=this.game.input.activePointer.position.y-this.game.input.activePointer.positionDown.y,e={x:this.game.input.activePointer.positionDown.x,y:this.game.input.activePointer.positionDown.y},a=Math.abs(i),o=Math.abs(n);return!this.diagonalDisabled&&a>this.dragLength-this.diagonalDelta&&o>this.dragLength-this.diagonalDelta?i>0&&n>0?(t=this.DIRECTION_DOWN_RIGHT,null!==this.model&&this.model.downRight&&this.model.downRight(e)):i>0&&n<0?(t=this.DIRECTION_UP_RIGHT,null!==this.model&&this.model.upRight&&this.model.upRight(e)):i<0&&n>0?(t=this.DIRECTION_DOWN_LEFT,null!==this.model&&this.model.downLeft&&this.model.downLeft(e)):i<0&&n<0&&(t=this.DIRECTION_UP_LEFT,null!==this.model&&this.model.upLeft&&this.model.upLeft(e)):(a>this.dragLength||o>this.dragLength)&&(a>o?i>0?(t=this.DIRECTION_RIGHT,null!==this.model&&this.model.right&&this.model.right(e)):i<0&&(t=this.DIRECTION_LEFT,null!==this.model&&this.model.left&&this.model.left(e)):n>0?(t=this.DIRECTION_DOWN,null!==this.model&&this.model.down&&this.model.down(e)):n<0&&(t=this.DIRECTION_UP,null!==this.model&&this.model.up&&this.model.up(e))),null!==t?(e.direction=t,e):null},void 0!==i&&void 0!==t&&t.exports&&(t.exports=n)},{}],4:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var a=e("./states/boot"),o=n(a),r=e("./states/endcard"),s=n(r),l=e("./states/preloader"),u=n(l),c=new Phaser.Game(document.body.clientWidth*window.devicePixelRatio,document.body.clientHeight*window.devicePixelRatio,Phaser.CANVAS,"game",null,!0);c.state.add("boot",new o.default),c.state.add("endcard",new s.default),c.state.add("preloader",new u.default),c.state.start("boot")},{"./states/boot":28,"./states/endcard":29,"./states/preloader":30}],5:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(){n(this,e),this.audios=[]}return a(e,[{key:"initAudio",value:function(e,t){null==this.audios[e]&&(this.audios[e]=new Audio(t),this.audios[e].muted=!0)}},{key:"play",value:function(e,t,i){null==this.audios[e]?this.audios[e]=new Audio(t):(this.initAudioArgs(e,i),this.audios[e].play(),void 0!==i&&void 0!==i.volume&&(this.audios[e].volume=i.volume))}},{key:"isAudioPlaying",value:function(e){return e.currentTime>0&&!e.paused}},{key:"fadeOut",value:function(e){null!=this.audios[e]&&this.audios[e].fadeOut()}},{key:"pause",value:function(e){null!=this.audios[e]&&this.audios[e].pause()}},{key:"mute",value:function(e){null!=this.audios[e]&&(this.audios[e].muted=!0)}},{key:"muteAll",value:function(){for(var e in this.audios)this.audios.hasOwnProperty(e)&&(this.audios[e].pause(),this.audios[e].muted=!0)}},{key:"unmuteAll",value:function(){for(var e in this.audios)this.audios.hasOwnProperty(e)&&(this.audios[e].muted=!1)}},{key:"initAudioArgs",value:function(e,t){this.audios[e].muted=!1,this.audios[e].autoplay=!0,void 0!==t&&void 0!==t.loop&&"boolean"==typeof t.loop&&(this.audios[e].loop=t.loop)}}]),e}();i.default=o},{}],6:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e("../prefabs/collectible"),r=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t){n(this,e),this.game=t,this.initSignals(),void 0!==PiecSettings.collectibles&&this.createCollectibles(),this.setupController()}return a(e,[{key:"initSignals",value:function(){this.onHudCreate=new Phaser.Signal,this.onCollectUpdate=new Phaser.Signal}},{key:"setupController",value:function(){}},{key:"createCollectibles",value:function(){this.collectibles=[];for(var e in PiecSettings.collectibles){var t=new r.default(this.game,e,PiecSettings.collectibles[e]);t.onHudCreate.add(function(e,t){this.onHudCreate.dispatch(e,t)},this),t.onCollectUpdate.add(function(e,t){this.onCollectUpdate.dispatch(e,t)},this),this.collectibles[e]=t}}},{key:"getCollectible",value:function(e){return this.collectibles[e]}}]),e}();i.default=s},{"../prefabs/collectible":7}],7:[function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=e("../prefabs/audio-controller"),c=a(u),h=e("../utils/container-util"),d=n(h),f=e("../utils/animations-util"),g=(n(f),e("../utils/tweener")),p=n(g),m=e("../prefabs/counter"),v=a(m),y=function(e){function t(e,i,n){o(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.collectibleKey=i,a.initSignals(),a.config=n,a.updateCounterValueDuration=void 0!==n.updateCounterValueDuration?n.updateCounterValueDuration:150,a.amount=n.initialValue,a.minValue=n.valueRange.min,a.maxValue=n.valueRange.max,void 0!==n.counter&&a.initCounter(n.counter),void 0!==n.sounds&&a.initSounds(n.sounds),a.game.time.events.add(100,function(){this.onHudCreate.dispatch(n.counter.tag,this.collectibleCounter),this.onCollectUpdate.dispatch(this.collectibleKey,this.amount)},a),a}return s(t,e),l(t,[{key:"initSignals",value:function(){this.onHudCreate=new Phaser.Signal,this.onCollectUpdate=new Phaser.Signal}},{key:"initSounds",value:function(){this.audioController=new c.default}},{key:"initCounter",value:function(e){e.initialValue=this.amount,e.maxValue=this.maxValue,e.minValue=this.minValue,this.collectibleCounter=new v.default(this.game,e),this.collectibleCounter.hide()}},{key:"spawnCollectibles",value:function(e){var t=e.amount,i=e.lifetime,n=e.spawnArea;t=Math.min(t,30);for(var a=0;a<t;a++){var o=new Phaser.Sprite(this.game,0,0,this.config.src);this.add(o),d.fitInContainer(o,this.config.htmlTag,.5,.5),o.x=d.getRandomXWithinContainer(n),o.y=d.getRandomYWithinContainer(n),o.alpha=1,o.angle=90,this.collectibleItemAppear(o,200*Math.random(),i,n),o.inputEnabled=!0,o.input.useHandCursor=!0,o.events.onInputDown.add(function(e){this.collectItem(e)},this)}}},{key:"collectibleItemAppear",value:function(e,t,i,n){var a=e.x,o=e.y,r=e.scale.x;e.x=d.getXCenterWithinContainer(n),e.y=d.getYCenterWithinContainer(n),e.scale.x=.001,e.scale.y=.001,this.game.add.tween(e).to({x:a,y:[o-.5*d.getYCenterWithinContainer(n),o],angle:0},500,Phaser.Easing.Quadratic.InOut,!0,t).onComplete.add(function(){p.jiggleAngle(e,20,200,100),this.game.time.events.add(i+100*Math.random(),function(){e.inputEnabled&&this.collectibleItemDisappear(e)},this)},this),this.game.add.tween(e.scale).to({x:r,y:r},200,Phaser.Easing.Quadratic.InOut,!0,t+100)}},{key:"increaseCollectibleAmount",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.amount+e;this.setCollectibleAmount(i,t)}},{key:"setCollectibleAmount",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e<this.amount&&0!=this.amount&&this.game.time.events.add(300,function(){t&&this.dropOutEffect(),null!=this.audioController&&void 0!==this.config.sounds.lose&&this.audioController.play("coin-empty",PiecSettings.assetsDir+this.config.sounds.lose)},this),this.amount=Math.min(Math.max(e,this.minValue),this.maxValue),null!=this.collectibleCounter&&(this.collectibleCounter.changeCounterTo(this.amount,this.updateCounterValueDuration),this.onCollectUpdate.dispatch(this.collectibleKey,this.amount))}},{key:"collectItem",value:function(e){e.inputEnabled=!1,this.amount+=this.config.eachItemCountsAs,this.amount=Math.min(Math.max(this.amount,this.minValue),this.maxValue),null!=this.collectibleCounter&&(this.collectibleCounter.changeCounterTo(this.amount,this.updateCounterValueDuration),this.onCollectEffect(e,this.config.onCollectEffects),this.onCollectUpdate.dispatch(this.collectibleKey,this.amount)),null!=this.audioController&&void 0!==this.config.sounds.collect&&this.audioController.play("coin-pickup-"+this.amount,PiecSettings.assetsDir+this.config.sounds.collect)}},{key:"collectibleItemDisappear",value:function(e){e.inputEnabled&&(e.inputEnabled=!1);var t=e.scale.x;p.scaleTo(e,[1.2*t,0],[1.2*t,0],300*Math.random(),500,Phaser.Easing.Quadratic.Out),p.fadeOut(e,0,800,Phaser.Easing.Quadratic.out,!0,function(){e.destroy()}),void 0!==e&&this.spawnCloudExplosion(e)}},{key:"spawnCloudExplosion",value:function(e){if(null!=e&&void 0!=e)for(var t=0;t<30;t++){var i=new Phaser.Sprite(this.game,0,0,"cloud");this.game.add.existing(i),i.anchor.set(.5);var n=e.width/i.width;i.x=e.position.x,i.y=e.position.y,i.scale.x=n,i.scale.y=n;var a=i.y,o=i.x,r=e.width*(Math.random()-.5),s=e.height*(Math.random()-.5),l=o+r,u=a+s,n=0,c=100*Math.random(),h=50*Math.random()+400;p.scaleOut(i,c,h,Phaser.Easing.Quadratic.Out,function(e){e.alpha=0,e.destroy()}),p.moveTo(i,l,u,c,h,Phaser.Easing.Linear.InOut,null,!0)}}},{key:"onCollectEffect",value:function(e,t){for(var i=0;i<t.length;i++)switch(t[i]){case"flyToGoal":this.flyToGoal(e)}}},{key:"flyToGoal",value:function(e){var t=this.collectibleCounter.x,i=this.collectibleCounter.y;this.game.add.tween(e).to({x:t,y:i},400,Phaser.Easing.Back.InOut,!0,0),this.game.add.tween(e.scale).to({x:.01,y:.01},100,Phaser.Easing.Quadratic.InOut,!0,300)}},{key:"dropOutEffect",value:function(){for(var e=(this.collectibleCounter.x,this.collectibleCounter.y,2*(Math.random()+5)),t=0;t<e;t++){var i=new Phaser.Sprite(this.game,0,0,this.config.src);this.game.add.existing(i),d.fitInContainer(i,this.config.htmlTag,.5,.5),i.x=this.collectibleCounter.x,i.y=this.collectibleCounter.y,i.alpha=1,i.angle=90*(Math.random()-.5);var n=100*Math.random(),a=this,o=.8*this.game.global.windowHeight;p.moveTo(i,i.x+(Math.random()-.5)*this.collectibleCounter.width,[i.y-i.height/2,o],n,500,Phaser.Easing.Linear.Out,function(e){p.fadeOut(e,0,300,Phaser.Easing.Quadratic.out,!0,function(){e.destroy()}),void 0!==e&&a.spawnCloudExplosion(e)})}}}]),t}(Phaser.Group);i.default=y},{"../prefabs/audio-controller":5,"../prefabs/counter":8,"../utils/animations-util":31,"../utils/container-util":32,"../utils/tweener":35}],8:[function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e("../utils/util"),u=n(l),c=e("../utils/container-util"),h=n(c),d=function(e){function t(e,i){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));switch(n.currentValue=i.initialValue,n.maxValue=i.maxValue,n.minValue=i.minValue,n.args=i,n.getContainerInfo(n.args.htmlTag),null!=n.args.backgroundSrc&&n.createCounterBackground(),n.visualStyle=i.style,i.style){case"number":n.createNumberCounter();break;case"rectangle_progressbar":n.createRectProgressBarCounter();break;case"circle_progressbar":n.createCircleProgressBarCounter();break;default:console.log("please set the counter style")}return n.game.add.existing(n),n.x+=n.counterBackground.width/2,n.y+=n.counterBackground.height/2,n.anchor=[],n.anchor.x=.5,n.anchor.y=.5,n}return r(t,e),s(t,[{key:"getContainerInfo",value:function(e){this.containerWidth=h.getContainerWidth(e),this.containerHeight=h.getContainerHeight(e),this.x=h.getContainerX(e),this.y=h.getContainerY(e)}},{key:"createRectProgressBarCounter",value:function(){this.barFilling=new Phaser.Sprite(this.game,0,0,this.args.backgroundSrc+"-fill"),this.add(this.barFilling),this.barFilling.anchor.set(0,.5),void 0!==this.args.htmlTagFill?(h.fitInContainer(this.barFilling,this.args.htmlTagFill),this.barFilling.x=-this.counterBackground.width/2,this.barFilling.y=-this.counterBackground.height/2,this.barFilling.x+=h.getContainerX(this.args.htmlTagFill)-h.getContainerX(this.args.htmlTag),this.barFilling.y+=h.getContainerY(this.args.htmlTagFill)-h.getContainerY(this.args.htmlTag)):(this.barFilling.x=this.counterBackground.x,this.barFilling.y=this.counterBackground.y+this.counterBackground.height/2,this.barFilling.scale.x=this.counterBackground.width/this.barFilling.width,this.barFilling.scale.y=this.counterBackground.height/this.barFilling.height*.75),this.fullWidthFilling=this.barFilling.scale.x,void 0!==this.maxValue&&(this.barFilling.scale.x=this.currentValue/this.maxValue*this.fullWidthFilling),void 0!==this.args.iconSrc&&this.createCounterIcon("outside"),void 0!==this.args.textFormat&&(this.createTextCounter(),this.updateTextCounter())}},{key:"createCircleProgressBarCounter",value:function(){this.barFilling=new Phaser.Sprite(this.game,0,0,this.args.backgroundSrc+"-fill"),this.add(this.barFilling),this.barFilling.anchor.set(.5),this.barFilling.x=this.counterBackground.x+this.counterBackground.width/2,this.barFilling.y=this.counterBackground.y+this.counterBackground.height/2,this.barFilling.scale.x=this.counterBackground.width/this.barFilling.width,this.barFilling.scale.y=this.counterBackground.height/this.barFilling.height,this.maskAngle={from:90,to:450},this.fullWidthFilling=this.maskAngle.to-this.maskAngle.from,this.arcMask=this.game.add.graphics(0,0);var e=this.maskAngle.from+this.currentValue/this.maxValue*this.fullWidthFilling;this.arcMask.beginFill(16777215),this.arcMask.arc(this.barFilling.x,this.barFilling.y,this.barFilling.width/2,this.game.math.degToRad(e),this.game.math.degToRad(this.maskAngle.from),!0),this.barFilling.mask=this.arcMask,this.add(this.arcMask)}},{key:"createTextCounter",value:function(){var e,t="bold",i=PiecSettings.fontFamily,n=[PiecSettings.fontColor],a=null,o=null,r=null,s=.5,l=.5;if(void 0!=this.args.fontStyle){var u=this.args.fontStyle;t=u.fontWeight,e=void 0!==this.args.htmlTagText?h.getContainerHeight(this.args.htmlTagText):this.counterBackground.height*u.fontSize||.5*this.counterBackground.height,i=u.fontFamily,n=u.color,a=u.stroke||null,o=u.strokeThickness||null,r=u.shadow||null,s=u.anchor.x||.5,l=u.anchor.y||.5}var c={font:t+" "+e+"px "+i,align:"center"},d=0;void 0!==this.args.iconSrc&&(d=.2),this.textField=new Phaser.Text(this.game,this.counterBackground.width*(.5+d),0,"",c),this.updateTextCounter(),this.textField.x-=this.counterBackground.width/2,this.add(this.textField),this.textField.anchor.set(s,l),this.textField.align="center",this.textField.padding.set(e/2,0),this.textField.initialScale=this.textField.scale.x,this.textField.fill="black";var f=this.textField.context.createLinearGradient(0,0,0,this.height);if(void 0!==n&&n.length>0)for(var g=0;g<n.length;g++){var p=g/n.length;f.addColorStop(p,n[g])}if(this.textField.fill=f,null!==a&&(this.textField.stroke=a),void 0!==o&&(this.textField.strokeThickness=o),null!==r){var m=r;this.textField.setShadow(m.x,m.y,m.color,m.blur)}}},{key:"updateTextCounter",value:function(){var e=" "+Math.round(this.currentValue);if(null!=this.args.counterCommaSeparation&&this.args.counterCommaSeparation&&(e=" "+u.numberWithCommas(this.currentValue)),void 0!==this.args.textFormat){e=this.args.textFormat.split("*")[0]+e+this.args.textFormat.split("*")[1]}this.textField.text=e,void 0!==this.args.htmlTagText&&(this.textField.x=this.textField.width/2-this.counterBackground.width/2,this.textField.y=this.textField.height/2-this.counterBackground.height/2,this.textField.x+=h.getContainerX(this.args.htmlTagText)-h.getContainerX(this.args.htmlTag),this.textField.y+=h.getContainerY(this.args.htmlTagText)-h.getContainerY(this.args.htmlTag))}},{key:"createNumberCounter",value:function(){this.createTextCounter(),this.changeNumTo(this.currentValue,1),null!=this.args.iconSrc&&this.createCounterIcon("contain")}},{key:"createCounterIcon",value:function(e){this.counterIcon=new Phaser.Sprite(this.game,0,0,this.args.iconSrc),this.add(this.counterIcon);var t=void 0!==this.args.iconScale?this.args.iconScale:.7;this.counterIcon.anchor.set(.5,.5),void 0!==this.args.htmlTagIcon?(h.fitInContainer(this.counterIcon,this.args.htmlTagIcon,.5,.5),this.counterIcon.x=h.getContainerX(this.args.htmlTagIcon)-h.getContainerX(this.args.htmlTag)-this.counterBackground.width/2+this.counterIcon.width/2,this.counterIcon.y=h.getContainerY(this.args.htmlTagIcon)-h.getContainerY(this.args.htmlTag)-this.counterBackground.height/2+this.counterIcon.height/2):("contain"==e?(this.counterIcon.scale.x=this.counterBackground.height*t/this.counterIcon.height,this.counterIcon.x=this.counterBackground.x+this.counterIcon.width):"outside"==e&&(this.counterIcon.scale.x=this.counterBackground.height*t/this.counterIcon.height,this.counterIcon.x=this.counterBackground.x-this.counterIcon.width),this.counterIcon.scale.y=this.counterIcon.scale.x,this.counterIcon.y=this.counterBackground.y+this.counterBackground.height/2)}},{key:"createCounterBackground",value:function(){this.counterBackground=new Phaser.Sprite(this.game,0,0,this.args.backgroundSrc),this.add(this.counterBackground),this.counterBackground.scale.x=this.containerWidth/this.counterBackground.width,this.counterBackground.scale.y=this.counterBackground.scale.x,this.counterBackground.x=-this.counterBackground.width/2,this.counterBackground.y=-this.counterBackground.height/2}},{key:"createCounterGraphicContainer",value:function(e){var t=new Phaser.Graphics(this.game,0,0);t.beginFill(16777215,0),t.drawRect(h.getContainerX(e),h.getContainerY(e),h.getContainerWidth(e),h.getContainerHeight(e)),this.counterBackground=t,this.add(this.counterBackground)}},{key:"changeCounterTo",value:function(e,t){var i=this.calcSpeedFromDuration(e,t);switch(this.visualStyle){case"number":if(this.changeNumTo(e,10*i,10),this.textField){this.game.add.tween(this.textField.scale).to({x:1.4*this.textField.initialScale,y:1.4*this.textField.initialScale},1*t/4,Phaser.Easing.Linear.None,!0,1*t/3).onComplete.add(function(){this.game.add.tween(this.textField.scale).to({x:this.textField.initialScale,y:this.textField.initialScale},1*t/4,Phaser.Easing.Linear.None,!0,0)},this)}break;case"rectangle_progressbar":this.changeRectBarTo(e,10*i,10);break;case"circle_progressbar":this.changeCircleBarTo(e,10*i,10)}}},{key:"setCounterTo",value:function(e){switch(this.visualStyle){case"number":this.setNumTo(e);break;case"rectangle_progressbar":this.setRectBarTo(e);break;case"circle_progressbar":this.setCircleBarTo(e)}}},{key:"calcSpeedFromDuration",value:function(e,t){return Math.abs(e-this.currentValue)/t}},{key:"setNumTo",value:function(e){this.currentValue=e,this.updateTextCounter()}},{key:"setRectBarTo",value:function(e){this.currentValue=e,void 0!==this.barFilling.tween&&null!=this.barFilling.tween&&this.game.tweens.remove(this.barFilling.tween),this.barFilling.tween=this.game.add.tween(this.barFilling.scale).to({x:this.currentValue/this.maxValue*this.fullWidthFilling},200,Phaser.Easing.Linear.None,!0,0),this.textField&&this.updateTextCounter()}},{key:"changeNumTo",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;void 0!==this.args.iconText&&this.args.iconText;e>this.currentValue?this.currentValue<e&&(this.currentValue+=t,this.currentValue>e&&(this.currentValue=e),this.game.time.events.add(i,function(){this.textField&&this.updateTextCounter(),this.currentValue<e&&this.changeNumTo(e,t,i)},this)):this.currentValue>=e&&(this.currentValue-=t,this.currentValue<e&&(this.currentValue=e),this.game.time.events.add(i,function(){this.textField&&this.updateTextCounter(),this.currentValue>e&&this.changeNumTo(e,t,i)},this))}},{key:"changeRectBarTo",value:function(e,t,i){e>this.currentValue?this.currentValue<e&&(this.currentValue+=t,this.currentValue>e&&(this.currentValue=e),this.game.time.events.add(i,function(){this.barFilling.scale.x=this.currentValue/this.maxValue*this.fullWidthFilling,this.textField&&this.updateTextCounter(),this.currentValue<e&&this.changeRectBarTo(e,t,i)},this)):this.currentValue>e&&(this.currentValue-=t,this.currentValue<e&&(this.currentValue=e),this.game.time.events.add(i,function(){this.barFilling.scale.x=this.currentValue/this.maxValue*this.fullWidthFilling,this.currentValue>e&&this.changeRectBarTo(e,1,i)},this))}},{key:"setCircleBarTo",value:function(e){this.currentValue=e;var t=this.maskAngle.from+this.currentValue/this.maxValue*this.fullWidthFilling;this.arcMask.clear(),this.arcMask.beginFill(16777215),this.arcMask.arc(this.barFilling.x,this.barFilling.y,this.barFilling.width/2,this.game.math.degToRad(t),this.game.math.degToRad(this.maskAngle.from),!0)}},{key:"changeCircleBarTo",value:function(e,t,i){if(e>this.currentValue){if(this.currentValue<e){this.currentValue+=t,this.currentValue>e&&(this.currentValue=e);var n=this.maskAngle.from+this.currentValue/this.maxValue*this.fullWidthFilling;this.game.time.events.add(i,function(){this.arcMask.arc(this.barFilling.x,this.barFilling.y,this.barFilling.width/2,this.game.math.degToRad(n),this.game.math.degToRad(this.maskAngle.from),!0),this.currentValue<e&&this.changeCircleBarTo(e,t)},this)}}else if(this.currentValue>e){this.currentValue-=t,this.currentValue<e&&(this.currentValue=e);var n=this.maskAngle.from+this.currentValue/this.maxValue*this.fullWidthFilling;this.arcMask.clear(),this.game.time.events.add(i,function(){this.arcMask.beginFill(16777215),this.arcMask.arc(this.barFilling.x,this.barFilling.y,this.barFilling.width/2,this.game.math.degToRad(n),this.game.math.degToRad(this.maskAngle.from),!0),this.currentValue>e&&this.changeCircleBarTo(e,t)},this)}}},{key:"hide",value:function(){this.alpha=0}},{key:"show",value:function(){this.alpha=1}},{key:"getXCoord",value:function(){}},{key:"getYCoord",value:function(){}}]),t}(Phaser.Group);i.default=d},{"../utils/container-util":32,"../utils/util":36}],9:[function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e("../utils/container-util"),u=n(l),c=e("../utils/animations-util"),h=(n(c),e("../utils/custom-png-sequences-renderer.js")),d=(n(h),e("../utils/util")),f=n(d),g=function(e){function t(e,i){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return void 0!==i.OSsensitive&&1==i.OSsensitive&&(i.src=f.getDeviceOS()+"-"+i.src),n.args=i,n.initSignals(),void 0!==i.src&&""!=i.src?n.createButton(i):n.createInteractiveArea(i),n.button.inputEnabled=!0,n.button.input.useHandCursor=!0,n.button.events.onInputDown.add(function(){this.game.time.events.add(50,function(){parent.postMessage("download","*")},this)},n),n.game.world.bringToTop(n),n.hide(),n.anchor=[],n.anchor.x=n.args.anchor.x,n.anchor.y=n.args.anchor.y,n}return r(t,e),s(t,[{key:"createButton",value:function(e){this.button=new Phaser.Sprite(this.game,0,0,e.src),this.button.x-=this.button.width*this.args.anchor.x,this.button.y-=this.button.height*this.args.anchor.y,this.add(this.button),this.button.bringToTop(),u.fitInContainer(this,e.container,this.args.anchor.x,this.args.anchor.y)}},{key:"createInteractiveArea",value:function(e){var t=new Phaser.Graphics(this.game,0,0);t.beginFill(16777215,0),t.drawRect(-u.getContainerWidth(e.container)*this.args.anchor.x,-u.getContainerHeight(e.container)*this.args.anchor.y,u.getContainerWidth(e.container),u.getContainerHeight(e.container)),this.button=t,this.add(this.button),u.fitInContainer(this,e.container,this.args.anchor.x,this.args.anchor.y)}},{key:"initSignals",value:function(){this.onInteract=new Phaser.Signal}},{key:"show",value:function(){this.alpha<1&&(this.alpha=1),this.button.inputEnabled=!0}},{key:"hide",value:function(){this.alpha>0&&(this.alpha=0),this.button.inputEnabled=!1}},{key:"enable",value:function(){this.button.inputEnabled||(this.button.inputEnabled=!0)}},{key:"disable",value:function(){this.button.inputEnabled&&(this.button.inputEnabled=!1)}},{key:"fitInContainer",value:function(e){u.fitInContainer(this,e,this.anchor.x,this.anchor.y)}}]),t}(Phaser.Group);i.default=g},{"../utils/animations-util":31,"../utils/container-util":32,"../utils/custom-png-sequences-renderer.js":33,"../utils/util":36}],10:[function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e("../utils/container-util"),u=n(l),c=e("../utils/util"),h=n(c),d=function(e){function t(e,i){a(this,t)
;void 0!==i.OSsensitive&&1==i.OSsensitive&&(i.src=h.getDeviceOS()+"-"+i.src);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,0,0,i.src));return u.fitInContainer(n,i.container,i.anchor.x,i.anchor.y),n.game.add.existing(n),n.currentContainer=i.container,n.alpha=0,n}return r(t,e),s(t,[{key:"show",value:function(){this.alpha<1&&(this.alpha=1)}},{key:"hide",value:function(){this.alpha>0&&(this.alpha=0)}},{key:"enable",value:function(){}},{key:"disable",value:function(){}},{key:"fitInContainer",value:function(e){u.fitInContainer(this,e,this.anchor.x,this.anchor.y)}}]),t}(Phaser.Sprite);i.default=d},{"../utils/container-util":32,"../utils/util":36}],11:[function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e("../utils/container-util"),u=n(l),c=e("../utils/tweener"),h=(n(c),e("../utils/util")),d=n(h),f=function(e){function t(e,i){a(this,t);var n=(i.text,u.getContainerHeight(i.container)),r={font:i.style.fontWeight+" "+n+"px "+i.style.fontFamily+","+PiecSettings.genericFontFamily},s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,0,0,i.text,r)),l=s.context.createLinearGradient(0,0,0,s.height);if(void 0!==i.style.color&&i.style.color.length>0)for(var c=0;c<i.style.color.length;c++){var h=c/i.style.color.length;l.addColorStop(h,i.style.color[c])}if(s.fill=l,void 0!==i.style.stroke&&(s.stroke=i.style.stroke),void 0!==i.style.strokeThickness&&(s.strokeThickness=i.style.strokeThickness),void 0!==i.style.shadow){var d=i.style.shadow;s.setShadow(d.x,d.y,d.color,d.blur,d.shadowStroke,d.shadowFill)}return s.game.add.existing(s),s.currentContainer=i.container,s.alpha=0,void 0!==i.autolocalise&&1==i.autolocalise&&void 0!==PiecSettings.translations[s.text]?s.autolocalise():s.text=" "+s.text+" ",void 0!==i.style.fontCase&&"uppercase"==i.style.fontCase&&(s.text=s.text.toUpperCase(),s.game.time.events.add(50,function(){this.text=this.text.toUpperCase()},s)),u.bestFit(s,i.container,i.anchor.x,i.anchor.y),s}return r(t,e),s(t,[{key:"show",value:function(){this.alpha<1&&(this.alpha=1)}},{key:"hide",value:function(){this.alpha>0&&(this.alpha=0)}},{key:"enable",value:function(){}},{key:"disable",value:function(){}},{key:"autolocalise",value:function(){var e=d.getDeviceLang();void 0!==PiecSettings.translations[this.text][e]&&(this.text=" "+PiecSettings.translations[this.text][e]+" ")}},{key:"fitInContainer",value:function(e){u.bestFit(this,e,this.anchor.x,this.anchor.y)}}]),t}(Phaser.Text);i.default=f},{"../utils/container-util":32,"../utils/tweener":35,"../utils/util":36}],12:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e("../ext/swipe"),r=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t){n(this,e),this.game=t,this.swipe=new r.default(this.game),this.initSignals()}return a(e,[{key:"initSignals",value:function(){this.onSwipe=new Phaser.Signal}},{key:"update",value:function(){this.updateSwipe()}},{key:"updateSwipe",value:function(){var e=this.swipe.check();if(null!==e)switch(e.direction){case this.swipe.DIRECTION_LEFT:this.onSwipe.dispatch(this.correctDirectionForRotatedWorld("LEFT"));break;case this.swipe.DIRECTION_RIGHT:this.onSwipe.dispatch(this.correctDirectionForRotatedWorld("RIGHT"));break;case this.swipe.DIRECTION_UP:this.onSwipe.dispatch(this.correctDirectionForRotatedWorld("UP"));break;case this.swipe.DIRECTION_DOWN:this.onSwipe.dispatch(this.correctDirectionForRotatedWorld("DOWN"));break;case this.swipe.DIRECTION_UP_LEFT:this.onSwipe.dispatch(this.correctDirectionForRotatedWorld("UPLEFT"));break;case this.swipe.DIRECTION_UP_RIGHT:this.onSwipe.dispatch(this.correctDirectionForRotatedWorld("UPRIGHT"));break;case this.swipe.DIRECTION_DOWN_LEFT:this.onSwipe.dispatch(this.correctDirectionForRotatedWorld("DOWNLEFT"));break;case this.swipe.DIRECTION_DOWN_RIGHT:this.onSwipe.dispatch(this.correctDirectionForRotatedWorld("DOWNRIGHT"))}}},{key:"correctDirectionForRotatedWorld",value:function(e){if(-90==this.game.world.angle)switch(e){case"LEFT":return"UP";case"RIGHT":return"DOWN";case"UP":return"RIGHT";case"DOWN":return"LEFT";case"UPLEFT":return"UPRIGHT";case"UPRIGHT":return"DOWNRIGHT";case"DOWNLEFT":return"UPLEFT";case"DOWNRIGHT":return"DOWNLEFT"}return e}}]),e}();i.default=s},{"../ext/swipe":3}],13:[function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e("../utils/container-util"),u=n(l),c=e("../utils/custom-png-sequences-renderer"),h=n(c),d=e("../prefabs/audio-controller"),f=(function(e){e&&e.__esModule}(d),function(e){function t(e,i,n,r){a(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.initSignals(),s.args=r,s.hudElementsController=n,void 0!==r.sounds&&(s.audioController=i),s.initialised=!1,s}return r(t,e),s(t,[{key:"init",value:function(){this.initialised||(this.createObjects(),this.createDock()),this.initialised=!0}},{key:"initSignals",value:function(){this.onSuccess=new Phaser.Signal,this.onFail=new Phaser.Signal,this.onHudCreate=new Phaser.Signal}},{key:"createObjects",value:function(){var e=this.args.objects;this.hiddenObjects=[];for(var t=0;t<e.length;t++){var i=e[t];if(i.isAnimation)var n=h.playPngSequence(this.game,i.src,this);else var n=new Phaser.Sprite(this.game,0,0,i.src);u.fitInContainer(n,i.htmlTag,.5,.5),this.game.add.existing(n),n.index=t,n.htmlTag=i.htmlTag,void 0!==i.opacity&&(n.alpha=i.opacity),n.inputEnabled=!0,n.input.useHandCursor=!0,n.events.onInputDown.add(function(e){e.inputEnabled=!1,this.flyToDock(e)},this),this.hiddenObjects.push(n)}}},{key:"createDock",value:function(){var e=this.args.counter;this.dockGrp=new Phaser.Group(this.game);var t=new Phaser.Sprite(this.game,0,0,e.backgroundSrc);this.dockGrp.add(t),this.game.add.existing(this.dockGrp),u.fitInContainer(t,e.htmlTag,0,0);var i=t.width*(1-2*e.padding.x)/this.args.objects.length,n=t.height*(1-2*e.padding.y);this.targetObjects=[],this.itemsFound=0;for(var a=0;a<this.args.objects.length;a++){var o=new Phaser.Sprite(this.game,0,0,this.args.objects[a].shadowSrc);this.dockGrp.add(o);var r=t.x+t.width*e.padding.x+i*a,s=t.y+t.height*e.padding.y;o.scale.x=.5*i/o.width*o.scale.x,o.scale.y=o.scale.x,o.height>n*e.padding.y&&(o.scale.y=n*(1-e.padding.y)/o.height*o.scale.y,o.scale.x=o.scale.y),o.x=r+o.width/2,o.y=s,this.targetObjects.push(o)}}},{key:"flyToDock",value:function(e){this.game.world.bringToTop(e),void 0!==this.args.sounds&&this.playAudio(),void 0!==this.args.successEffect&&""!=this.args.successEffect&&this.playEffect(e.htmlTag);var t=this.targetObjects[e.index],i=t.x+t.width/2,n=this.targetObjects[e.index].y+t.height/2,a=this.targetObjects[e.index].width/e.width*e.scale.x;this.game.add.tween(e).to({alpha:1,x:[u.getWorldCentre(this.game).x,i],y:[u.getWorldCentre(this.game).y,n]},1200,Phaser.Easing.Linear.Out,!0,0);var o=e.scale.x;this.game.add.tween(e.scale).to({x:[1.5*o,1.1*a],y:[1.5*o,1.1*a]},1200,Phaser.Easing.Linear.Out,!0,0).onComplete.add(function(){this.game.add.tween(t).to({alpha:1},100,Phaser.Easing.Linear.Out,!0,0).onComplete.add(function(){t.destroy()},this),++this.itemsFound==this.args.objects.length&&this.game.time.events.add(500,function(){this.onSuccess.dispatch(this)},this)},this)}},{key:"hide",value:function(){this.alpha>0&&(this.alpha=0)}},{key:"show",value:function(){this.alpha<1&&(this.alpha=1)}},{key:"disable",value:function(){this.hide()}},{key:"enable",value:function(){this.init(),this.show()}},{key:"playAudio",value:function(){void 0!==this.args.sounds&&void 0!==this.args.sounds.interact&&this.audioController.playAudio(this.args.sounds.interact,PiecSettings.assetsDir+this.args.sounds.interact,{loop:!1})}},{key:"playEffect",value:function(e){var t=h.playPngSequence(this.game,this.args.successEffect,null);u.fitInContainer(t,e,.5,.5)}},{key:"autoDestroy",value:function(e){var t;this.game.time.events.add(e,function(){t=this.game.add.tween(this.dockGrp).to({alpha:0},100,Phaser.Easing.Linear.out,!0,0);for(var e=0;e<this.hiddenObjects.length;e++){var i=this.hiddenObjects[e];this.game.add.tween(i).to({alpha:0},100,Phaser.Easing.Linear.out,!0,0).onComplete.add(function(){i.destroy()},this)}t?t.onComplete.add(function(){this.dockGrp.destroy(),this.destroy()},this):this.destroy()},this)}}]),t}(Phaser.Group));i.default=f},{"../prefabs/audio-controller":5,"../utils/container-util":32,"../utils/custom-png-sequences-renderer":33}],14:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=e("../utils/container-util"),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(s),u=function(e){function t(e,i,o){n(this,t);var r=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.initSignals(),r.args=o,void 0!==o.src&&""!=o.src?r.createButton(o):r.createInteractiveArea(o),r.button.inputEnabled=!0,r.button.input.useHandCursor=!0,"onInputUp"==o.onInteractEvent?r.game.input.onUp.add(function(){this.checkIfFingerIsOnInput(0)},r):"onInputDown"==o.onInteractEvent?r.game.input.onDown.add(function(){this.checkIfFingerIsOnInput(0)},r):r.button.events.onInputDown.add(function(){this.onInteract.dispatch(this)},r),r}return o(t,e),r(t,[{key:"checkIfFingerIsOnInput",value:function(e){if(this.button.inputEnabled){var t=this.game.input.x,i=this.game.input.y;if(-90==this.game.world.angle){var n=t;t=this.game.height-i,i=n}var a=this.button.worldX,o=this.button.worldY,r=this.button.worldWidth,s=this.button.worldHeight,l=a-r*this.button.anchor.x,u=o-s*this.button.anchor.y,c=a+r*(1-this.button.anchor.x),h=o+s*(1-this.button.anchor.y);t>l&&i>u&&t<c&&i<h&&this.onInteract.dispatch(this)}}},{key:"createButton",value:function(e){this.button=new Phaser.Sprite(this.game,0,0,e.src),this.button.anchor.set(.5),this.button.x+=this.button.width/2,this.button.y+=this.button.height/2,this.add(this.button),l.fitInContainer(this.button,e.container),this.button.worldX=this.button.x,this.button.worldY=this.button.y,this.button.worldWidth=this.button.width,this.button.worldHeight=this.button.height}},{key:"createInteractiveArea",value:function(e){var t=new Phaser.Graphics(this.game,0,0);t.beginFill(14554186,0),t.drawRect(l.getContainerX(e.container),l.getContainerY(e.container),l.getContainerWidth(e.container),l.getContainerHeight(e.container)),t.worldX=l.getContainerX(e.container),t.worldY=l.getContainerY(e.container),t.worldWidth=l.getContainerWidth(e.container),t.worldHeight=l.getContainerHeight(e.container),this.button=t,this.add(this.button)}},{key:"initSignals",value:function(){this.onInteract=new Phaser.Signal,this.onFail=new Phaser.Signal}},{key:"hide",value:function(){this.alpha>0&&(this.alpha=0)}},{key:"show",value:function(){this.alpha<1&&(this.alpha=1)}},{key:"disable",value:function(){this.button.inputEnabled&&(this.button.inputEnabled=!1),this.hide()}},{key:"enable",value:function(){this.button.inputEnabled||(this.button.inputEnabled=!0),this.show()}},{key:"autoDestroy",value:function(e){this.game.time.events.add(e,function(){this.destroy()},this)}}]),t}(Phaser.Group);i.default=u},{"../utils/container-util":32}],15:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e("../utils/util.js"),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(o),s=function(){function e(t,i,a){n(this,e),this.game=t,this.orientationLock=a,this.videoOrientation=i,this.windowWidth=document.body.clientWidth,this.windowHeight=document.body.clientHeight}return a(e,[{key:"update",value:function(){this.aspectRatio=document.body.clientWidth/document.body.clientHeight,"landscape"==this.orientationLock&&r.isPortrait()||"portrait"==this.orientationLock&&!r.isPortrait()?(this.resizeVideoToFillScreenRotated(document.getElementById("videoBg")),this.resizeWrapperToFillScreenRotated(document.getElementById("videoBg"),document.getElementById("vpiec-wrap")),this.resizeGameToFillScreenRotated(),parent.postMessage("close-align-left","*")):"landscape"==this.orientationLock&&!r.isPortrait()||"portrait"==this.orientationLock&&r.isPortrait()?(this.resizeVideoToFillScreenNormal(document.getElementById("videoBg")),this.resizeWrapperToFillScreenNormal(document.getElementById("videoBg"),document.getElementById("vpiec-wrap")),this.resizeGameToFillScreenNormal(),parent.postMessage("close-align-right","*")):"responsive"!=this.videoOrientation&&(this.resizeVideoToFillScreenNormal(document.getElementById("videoBg")),this.resizeWrapperToFillScreenNormal(document.getElementById("videoBg"),document.getElementById("vpiec-wrap")),this.resizeGameToFillScreenNormal(),parent.postMessage("close-align-right","*")),this.applySameChangesToGIFContainer()}},{key:"resizeGameToFillScreenNormal",value:function(){this.game.scale.setGameSize(this.getVideoWidth()*window.devicePixelRatio,this.getVideoHeight()*window.devicePixelRatio),this.game.scale.refresh(),this.game.world.angle=0,this.game.world.setBounds(0,0,this.game.world.bounds.width,this.game.world.bounds.height)}},{key:"resizeGameToFillScreenRotated",value:function(){this.game.scale.setGameSize(this.getVideoHeight()*window.devicePixelRatio,this.getVideoWidth()*window.devicePixelRatio),this.game.scale.refresh(),this.game.world.angle=-90,this.game.world.setBounds(0,-this.game.world.bounds.height,this.game.world.bounds.width,this.game.world.bounds.height)}},{key:"getVideoWidth",value:function(){return document.getElementById("vpiec-wrap").offsetWidth}},{key:"getVideoHeight",value:function(){return document.getElementById("vpiec-wrap").offsetHeight}},{key:"resizeWrapperToFillScreenRotated",value:function(e,t){this.resetWrapper(t),t.style.width=this.calcVideoHeightRotated(e),t.style.height=this.calcVideoWidthRotated(e)}},{key:"resizeWrapperToFillScreenNormal",value:function(e,t){this.resetWrapper(t),t.style.width=this.calcVideoWidthNormal(e),t.style.height=this.calcVideoHeightNormal(e)}},{key:"resizeWrapperToFillScreen",value:function(e,t){this.resetWrapper(t),t.style.width=this.windowWidth+"px",t.style.height=this.windowHeight+"px"}},{key:"calcVideoHeightRotated",value:function(e){return r.isPortrait()?this.aspectRatio>9/16?"landscape"==this.videoOrientation?e.offsetWidth+"px":9*e.offsetHeight/16+"px":"landscape"==this.videoOrientation?16*e.offsetHeight/9+"px":9*e.offsetHeight/16+"px":this.aspectRatio>16/9?(this.videoOrientation,e.offsetWidth+"px"):"landscape"==this.videoOrientation?e.offsetWidth+"px":9*e.offsetHeight/16+"px"}},{key:"calcVideoWidthRotated",value:function(e){return r.isPortrait()?this.aspectRatio>9/16?"landscape"==this.videoOrientation?9*e.offsetWidth/16+"px":e.offsetHeight+"px":(this.videoOrientation,e.offsetHeight+"px"):this.aspectRatio>16/9?"landscape"==this.videoOrientation?9*e.offsetWidth/16+"px":16*e.offsetWidth/9+"px":"landscape"==this.videoOrientation?9*e.offsetWidth/16+"px":e.offsetHeight+"px"}},{key:"calcVideoHeightNormal",value:function(e){return r.isPortrait()?this.aspectRatio>9/16?"landscape"==this.videoOrientation?9*e.offsetWidth/16+"px":e.offsetHeight+"px":"landscape"==this.videoOrientation?9*e.offsetWidth/16+"px":16*e.offsetWidth/9+"px":this.aspectRatio>16/9?e.offsetHeight+"px":"landscape"==this.videoOrientation?9*e.offsetWidth/16+"px":e.offsetHeight+"px"}},{key:"calcVideoWidthNormal",value:function(e){return r.isPortrait()?this.aspectRatio>9/16?"landscape"==this.videoOrientation?e.offsetWidth+"px":9*e.offsetHeight/16+"px":(this.videoOrientation,e.offsetWidth+"px"):this.aspectRatio>16/9?"landscape"==this.videoOrientation?16*e.offsetHeight/9+"px":9*e.offsetHeight/16+"px":"landscape"==this.videoOrientation?e.offsetWidth+"px":9*e.offsetHeight/16+"px"}},{key:"applySameChangesToGIFContainer",value:function(){var e=document.getElementById("gifBg");e.style.width=document.getElementById("videoBg").style.width,e.style.height=document.getElementById("videoBg").style.height,e.style.transform=document.getElementById("videoBg").style.transform,e.style.top=document.getElementById("videoBg").style.top,e.style.left=document.getElementById("videoBg").style.left}},{key:"resetWrapper",value:function(e){e.className="",e.style.top=0,e.style.left=0,e.style.padding=0,e.style.transform="none"}},{key:"resizeVideoToFillScreenNormal",value:function(e){e.style.width=this.windowWidth,e.style.height=this.windowHeight,e.style.transform="none",e.style.top="0",e.style.left="0"}},{key:"resizeVideoToFillScreenRotated",value:function(e){e.style.width=this.windowHeight+"px",e.style.height=this.windowWidth+"px",e.style.transform="rotate(-90deg)",e.style.top="100%",e.style.left="0"}}]),e}();i.default=s},{"../utils/util.js":36}],16:[function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=e("../prefabs/counter"),c=a(u),h=e("../utils/container-util"),d=n(h),f=e("../utils/particles-util"),g=n(f),p=e("../utils/util"),m=n(p),v=e("../utils/tweener"),y=n(v),b=e("../utils/custom-png-sequences-renderer"),w=n(b),P=e("../prefabs/audio-controller"),C=(a(P),function(e){function t(e,i,n,a,s){o(this,t);var l=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return l.initSignals(),l.args=s,l.handGestureController=i,l.hudElementsController=a,l.poweredUp=!1,l.completeInitialTween=!1,l.currentCheckpoint=0,l.completedCheckpoint=!1,l.currentPower=s.initialValue,l.minPower=s.valueRange.min,l.maxPower=s.valueRange.max,l.valueIncrementPerInteraction=s.valueIncrementPerInteraction,void 0!==l.args.checkpoints&&l.args.checkpoints.length>1?l.checkpoints=l.args.checkpoints:(l.checkpoints=[],l.checkpoints.push(100)),l.particles=[],void 0!==s.sounds&&(l.audioController=n,void 0!==s.sounds.interact&&l.audioController.initAudio(s.sounds.interact,PiecSettings.assetsDir+s.sounds.interact)),l.initialised=!1,l}return s(t,e),l(t,[{key:"init",value:function(){this.initialised||(this.createCounter(),this.createInteractiveArea(),this.initCounter(),this.createFollowFinger(),void 0!==this.args.tutorial&&void 0!==this.args.tutorial.tagName&&this.createTutorial(),this.initialised=!0)}},{key:"initSignals",value:function(){this.onSuccess=new Phaser.Signal,this.onFail=new Phaser.Signal,this.onHudCreate=new Phaser.Signal}},{key:"createCounter",value:function(){void 0!==this.args.counter&&(this.args.counter.initialValue=this.args.initialValue,this.args.counter.maxValue=this.args.valueRange.max,this.args.counter.minValue=this.args.valueRange.min,this.counter=new c.default(this.game,this.args.counter),this.game.time.events.add(10,function(){this.onHudCreate.dispatch(this.args.counter.tag,this.counter)},this),this.counter.scale.x=.01,this.counter.scale.y=.01,this.game.add.tween(this.counter.scale).to({x:1,y:1},700,Phaser.Easing.Elastic.Out,!0,0).onComplete.add(function(){this.completeInitialTween=!0},this))}},{key:"initCounter",value:function(){this.args.valueDecreasePerHalfSecond>0&&this.game.time.events.loop(500,function(){this.poweredUp||this.decreasePower(this.args.valueDecreasePerHalfSecond)},this),this.args.valueDecreasePerQuarterSecond>0&&this.game.time.events.loop(250,function(){this.poweredUp||this.decreasePower(this.args.valueDecreasePerQuarterSecond)},this),this.initAutoplayEvent()}},{key:"initAutoplayEvent",value:function(){this.autoplayEvent&&this.game.time.events.remove(this.autoplayEvent),this.autoplayEvent=this.game.time.events.add(this.args.currentStateAutoPlay-1e3,function(){this.game&&(void 0!==this.args.playCheckpointOnArrival&&this.args.playCheckpointOnArrival?this.increasePower(this.getCheckpointAmount(Math.min(this.currentCheckpoint+1,this.checkpoints.length-1))):0==this.currentCheckpoint&&this.increasePower(this.getCheckpointAmount(this.checkpoints.length-1)),this.dispatchOnSuccess())},this)}},{key:"reinitStateForPersistingInstance",value:function(){this.initialised&&this.initAutoplayEvent()}},{key:"createInteractiveArea",value:function(){"tap"==this.args.typeOfInteraction?this.createTapInteractiveArea():-1!=this.args.typeOfInteraction.indexOf("swipe")?this.createSwipeInteractiveArea():"scratch"==this.args.typeOfInteraction&&this.createScratchInteractiveArea()}},{key:"createTapInteractiveArea",value:function(){var e=this.args.htmlTag,t=new Phaser.Graphics(this.game,0,0);t.beginFill(14554186,0),t.drawRect(d.getContainerX(e),d.getContainerY(e),d.getContainerWidth(e),d.getContainerHeight(e)),t.worldX=d.getContainerX(e),t.worldY=d.getContainerY(e),t.worldWidth=d.getContainerWidth(e),t.worldHeight=d.getContainerHeight(e),this.button=t,this.add(this.button),this.button.inputEnabled=!0,this.button.input.useHandCursor=!0,this.button.events.onInputDown.add(function(){this.increasePower(this.valueIncrementPerInteraction),void 0!==this.args.particles&&void 0!==this.args.particles.src&&void 0!==this.args.particles.htmlTag&&this.args.particles.src.length>0&&(void 0===this.args.particles.effect||this.poweredUp||this.playEffect(this.args.particles.effect),void 0!==this.args.sounds&&void 0!==this.args.sounds.interact&&this.audioController.playAudio(this.args.sounds.interact,PiecSettings.assetsDir+this.args.sounds.interact,{loop:!1,volume:1}))},this)}},{key:"createFollowFingerSprite",value:function(){void 0!==this.args.followFinger&&void 0!==this.args.followFinger.src&&(-1!=this.args.followFinger.src.indexOf(".png")?this.followFingerSprite=new Phaser.Sprite(this.game,0,0,this.args.followFinger.src):this.followFingerSprite=w.playPngSequence(this.game,this.args.followFinger.src,null),d.fitInContainer(this.followFingerSprite,this.args.followFinger.htmlTag,this.args.followFinger.anchor.x,this.args.followFinger.anchor.y),this.game.add.existing(this.followFingerSprite),this.followFingerSprite.alpha=0,void 0!==this.args.followFinger.persistent&&this.args.followFinger.persistent&&(this.followFingerSprite.alpha=1,this.followFingerSpritePersistent=!0,this.followFingerSpriteFlyIn()))}},{key:"createTutorial",value:function(){this.tutorialElement=this.hudElementsController.hudObjects[this.args.tutorial.tagName],this.tutorialElement.show();var e=this.args.htmlTag;if(void 0!==this.args.tutorial.htmlTagSpawn&&(e=this.args.tutorial.htmlTagSpawn),"tap"==this.args.typeOfInteraction)this.tutorialLoop=this.game.time.events.loop(300,function(){var t=d.getRandomXWithinContainer(e),i=d.getRandomYWithinContainer(e);this.tutorialElement.x=t,this.tutorialElement.y=i;y.quickTap(this.tutorialElement,0,300,Phaser.Easing.Quadratic.InOut)},this);else if("scratch"==this.args.typeOfInteraction)y.tapAndHold(this.tutorialElement,0,900,Phaser.Easing.Quadratic.InOut),this.game.time.events.add(900,function(){void 0!==this.args.followFinger&&void 0!==this.args.followFinger.freedom&&"position"==this.args.followFinger.freedom||void 0!==this.args.followFinger&&void 0==this.args.followFinger.freedom?this.tutorialElementPositionScratch(e):void 0!==this.args.followFinger&&void 0!==this.args.followFinger.freedom&&"rotation"==this.args.followFinger.freedom&&this.tutorialElementRotationScratch(e)},this);else if(-1!=this.args.typeOfInteraction.indexOf("swipe")){var t=this.args.typeOfInteraction.split("swipe")[1].toLowerCase(),i=this.tutorialElement.scale.x,n=d.getContainerX(e),a=d.getContainerY(e);this.tutorialElementSwipe(i,n,a,t),this.tutorialLoop=this.game.time.events.loop(900,function(){this.tutorialElementSwipe(i,n,a,t)},this)}}},{key:"tutorialElementPositionScratch",value:function(e){var t,i,n,a;t=d.getContainerX(e),n=d.getContainerY(e)+d.getContainerHeight(e),i=d.getContainerX(e)+d.getContainerWidth(e),a=d.getContainerY(e);var o,r;o=t,r=n,y.moveTo(this.tutorialElement,i,a,0,350,Phaser.Easing.Quadratic.InOut).onComplete.add(function(){o=i,r=a},this),this.tutorialLoop=this.game.time.events.loop(400,function(){o=o==t?i:t,r=r==n?a:n;y.moveTo(this.tutorialElement,o,r,0,500,Phaser.Easing.Quadratic.InOut)},this)}},{key:"tutorialElementRotationScratch",value:function(e){y.circleAround(this.tutorialElement,d.getXCenterWithinContainer(e),d.getYCenterWithinContainer(e),1.5,0,1100,Phaser.Easing.Quadratic.InOut);this.tutorialLoop=this.game.time.events.loop(1200,function(){y.circleAround(this.tutorialElement,d.getXCenterWithinContainer(e),d.getYCenterWithinContainer(e),1.5,0,1200,Phaser.Easing.Quadratic.InOut)},this)}},{key:"tutorialElementSwipe",value:function(e,t,i,n){this.tutorialElement.scale.x=e,this.tutorialElement.scale.y=e,this.tutorialElement.x=t,this.tutorialElement.y=i,y.swipe(this.tutorialElement,0,600,Phaser.Easing.Quadratic.InOut,300,n)}},{key:"playEffect",value:function(e){var t=this.getGameXInput(),i=this.getGameYInput();if(null!=this.game)switch(e){case"burst":g.particleBurst(this.game,this.args.particles.src,this.args.particles.htmlTag,t,i,10);break;case"spawn":this.particles.push.apply(this.particles,g.particleSpawn(this.game,this.args.particles.src,this.args.particles.htmlTag,t,i,1));break;case"shootLeft":g.particleShoot(this.game,this.args.particles.src,this.args.particles.htmlTag,t,i,15,-1,1);break;case"spawnAndFade":var n=g.particleSpawn(this.game,this.args.particles.src,this.args.particles.htmlTag,t,i,1,30)[0],a=n.x,o=n.y;this.game.add.tween(n).to({x:[a+.1*n.width*(Math.random()>.5?1:-1),a+.1*n.width*(Math.random()>.5?1:-1)],y:o-.75*n.height,alpha:[1,0]},700,Phaser.Easing.Quadratic.Out,!0,0);var r=n.scale.x;this.game.add.tween(n.scale).to({x:[1.15*r,.9*r],y:[1.15*r,.9*r]},700,Phaser.Easing.Back.Out,!0,0);break;case"glitterRain":g.particleRain(this.game,this.args.particles.src,this.args.particles.htmlTag,this.args.particles.htmlTagGoal,t,i,15,0,10);break;case"glitterBurst":g.particleRain(this.game,this.args.particles.src,this.args.particles.htmlTag,this.args.particles.htmlTagGoal,t,i,15,10,40);break;default:g.particleBurst(this.game,this.args.particles.src,this.args.particles.htmlTag,t,i,10)}}},{key:"clearParticles",value:function(){for(var e=0;e<this.particles.length;e++)if(void 0==this.particles[e].tween||null==this.particles[e].tween){var t=this.game.add.tween(this.particles[e].scale).to({x:.001,y:.001},400,Phaser.Easing.Back.In,!0,0),i=this.particles[e];t.onComplete.add(function(){i.destroy()},this)}}},{key:"createSwipeInteractiveArea",value:function(){this.audioIndex=0,this.handGestureController.onSwipe.add(this.swipeDetected,this)}},{key:"swipeDetected",value:function(e){var t=this.args.typeOfInteraction;"swipeUp"==t&&"UP"==e?this.increasePower(this.valueIncrementPerInteraction):"swipeDown"==t&&"DOWN"==e?this.increasePower(this.valueIncrementPerInteraction):"swipeLeft"==t&&"LEFT"==e?this.increasePower(this.valueIncrementPerInteraction):"swipeRight"==t&&"RIGHT"==e?this.increasePower(this.valueIncrementPerInteraction):"swipeUpLeft"==t&&"UPLEFT"==e?this.increasePower(this.valueIncrementPerInteraction):"swipeUpRight"==t&&"UPRIGHT"==e?this.increasePower(this.valueIncrementPerInteraction):"swipeDownLeft"==t&&"DOWNLEFT"==e?this.increasePower(this.valueIncrementPerInteraction):"swipeDownRight"==t&&"DOWNRIGHT"==e&&this.increasePower(this.valueIncrementPerInteraction),void 0!==this.args.sounds&&void 0!==this.args.sounds.interact&&this.audioController.playAudio(this.args.sounds.interact,PiecSettings.assetsDir+this.args.sounds.interact,{loop:!1,volume:1})}},{key:"createScratchInteractiveArea",value:function(){this.updateCounter=!1,this.game.time.events.loop(100,function(){this.updateCounter=!0},this),this.game.input.addMoveCallback(this.updateCounterOnMove,this)}},{key:"createFollowFinger",value:function(){this.createFollowFingerSprite(),void 0!==this.args.followFinger&&(void 0!==this.args.followFinger.freedom&&"position"==this.args.followFinger.freedom||void 0==this.args.followFinger.freedom?(this.game.input.onDown.add(this.fingerSpriteFollowPositionDown,this),
this.game.input.onUp.add(this.fingerSpriteFollowPositionUp,this),this.game.input.addMoveCallback(this.fingerSpriteFollowPositionMove,this)):void 0!==this.args.followFinger.freedom&&"rotation"==this.args.followFinger.freedom&&(this.followFingerSprite.alpha=1,this.game.input.addMoveCallback(this.fingerSpriteFollowRotationMove,this),this.game.input.onUp.add(this.fingerSpriteFollowRotationUp,this)))}},{key:"getGameXInput",value:function(){var e=this.game.input.x,t=this.game.input.y;if(-90==this.game.world.angle){var i=e;e=this.game.height-t,t=i}return e}},{key:"getGameYInput",value:function(){var e=this.game.input.x,t=this.game.input.y;if(-90==this.game.world.angle){var i=e;e=this.game.height-t,t=i}return t}},{key:"updateCounterOnMove",value:function(){this.updateCounter&&(this.increasePower(this.valueIncrementPerInteraction),void 0!==this.args.particles&&this.playEffect(this.args.particles.effect),this.updateCounter=!1)}},{key:"fingerSpriteFollowPositionDown",value:function(){this.followFingerSprite&&(this.followFingerSprite.alpha=1,this.followFingerSprite.x=this.getGameXInput(),this.followFingerSprite.y=this.getGameYInput()),void 0!==this.args.sounds&&void 0!==this.args.sounds.interact&&this.audioController.playAudio(this.args.sounds.interact,PiecSettings.assetsDir+this.args.sounds.interact,{loop:!0,volume:1})}},{key:"fingerSpriteFollowPositionMove",value:function(e,t,i){this.followFingerSprite&&(this.followFingerSprite.x=this.getGameXInput(),this.followFingerSprite.y=this.getGameYInput())}},{key:"fingerSpriteFollowPositionUp",value:function(){this.followFingerSprite&&!this.followFingerSpritePersistent&&(this.followFingerSprite.alpha=0),void 0!==this.args.sounds&&void 0!==this.args.sounds.interact&&this.audioController.pauseAudio(this.args.sounds.interact)}},{key:"fingerSpriteFollowRotationMove",value:function(e,t,i){this.followFingerSprite&&(this.followFingerSprite.angle=m.getAngleBetweenTwoPoints(this.followFingerSprite.x,this.followFingerSprite.y,t,i)+90),void 0!==this.args.sounds&&void 0!==this.args.sounds.interact&&this.audioController.playAudio(this.args.sounds.interact,PiecSettings.assetsDir+this.args.sounds.interact,{loop:!0,volume:1})}},{key:"fingerSpriteFollowRotationUp",value:function(){this.followFingerSprite&&this.game.add.tween(this.followFingerSprite).to({angle:0},300,Phaser.Easing.Quadratic.Out,!0,0),void 0!==this.args.sounds&&void 0!==this.args.sounds.interact&&this.audioController.pauseAudio(this.args.sounds.interact)}},{key:"increasePower",value:function(e){this.currentPower+=e;var t=this.getCheckpointAmount(this.currentCheckpoint);this.currentPower>=t&&(this.currentPower=t,this.nextCheckpoint()),void 0!==this.args.playCheckpointOnArrival&&this.args.playCheckpointOnArrival?this.currentPower!=t||this.poweredUp||(y.pulseOnce(this.counter,0,300,Phaser.Easing.Quadratic.InOut),this.game.time.events.remove(this.autoplayEvent),this.dispatchOnSuccess()):this.currentPower!=this.maxPower||this.poweredUp||(y.pulseOnce(this.counter,0,300,Phaser.Easing.Quadratic.InOut),this.dispatchOnSuccess()),this.counter.setCounterTo(Math.min(this.currentPower,this.maxPower)),this.currentCheckpoint==this.checkpoints.length-1&&this.scaleCounter(1.4),this.cancelTutorial()}},{key:"dispatchOnSuccess",value:function(){this.currentPower==this.maxPower&&(this.poweredUp=!0),this.clearParticles(),this.onSuccess.dispatch(this,Math.max(0,this.currentCheckpoint-1))}},{key:"getCheckpointAmount",value:function(e){return Math.min(this.checkpoints[e]/100*this.maxPower,this.maxPower)}},{key:"nextCheckpoint",value:function(){this.checkpoints.length>1&&this.currentCheckpoint++}},{key:"decreasePower",value:function(e){if(!this.poweredUp){this.currentPower-=e;var t=this.minPower;this.currentCheckpoint>0&&(t=this.getCheckpointAmount(this.currentCheckpoint-1)),this.currentPower<t&&(this.currentPower=t),this.counter.setCounterTo(this.currentPower),this.currentPower<=1*this.maxPower/2&&this.scaleCounter(1)}}},{key:"scaleCounter",value:function(e){null!=this.game&&this.completeInitialTween&&(void 0!==this.counter.tween&&null!=this.counter.tween&&this.game.tweens.remove(this.counter.tween),this.counter.tween=this.game.add.tween(this.counter.scale).to({x:e,y:e},400,Phaser.Easing.Linear.None,!0,0))}},{key:"cancelTutorial",value:function(){this.tutorialLoop&&this.game.time.events.remove(this.tutorialLoop),this.tutorialElement&&this.tutorialElement.hide()}},{key:"hide",value:function(){this.alpha>0&&(this.alpha=0)}},{key:"show",value:function(){this.alpha<1&&(this.alpha=1)}},{key:"disable",value:function(){this.hide()}},{key:"enable",value:function(){this.init(),this.show()}},{key:"followFingerSpriteFlyIn",value:function(){var e=this.followFingerSprite.x,t=this.followFingerSprite.y;this.followFingerSprite.x=this.game.global.windowWidth+.6*this.followFingerSprite.width,this.followFingerSprite.y+=.1*this.followFingerSprite.height,this.followFingerSprite.angle=10,this.game.add.tween(this.followFingerSprite).to({x:e,y:t,angle:0},1e3,Phaser.Easing.Quadratic.InOut,!0,0).interpolation(function(e,t){return Phaser.Math.bezierInterpolation(e,t)})}},{key:"followFingerSpriteFlyOut",value:function(){if(this.followFingerSpritePersistent){var e=this.followFingerSprite.y;return this.game.add.tween(this.followFingerSprite).to({x:.6*-this.followFingerSprite.width,y:[e+.1*this.followFingerSprite.height,e-.1*this.followFingerSprite.height],angle:[10,-5]},2e3,Phaser.Easing.Quadratic.InOut,!0,0).interpolation(function(e,t){return Phaser.Math.bezierInterpolation(e,t)})}return null}},{key:"autoDestroy",value:function(e){var t;this.game.time.events.add(e,function(){this.followFingerSprite&&(this.game.input.deleteMoveCallback(this.fingerSpriteFollowPositionMove,this),this.game.input.deleteMoveCallback(this.fingerSpriteFollowRotationMove,this),this.game.input.deleteMoveCallback(this.updateCounterOnMove,this),this.game.input.onDown.remove(this.fingerSpriteFollowPositionDown,this),this.game.input.onUp.remove(this.fingerSpriteFollowPositionUp,this),this.game.input.onUp.remove(this.fingerSpriteFollowRotationUp,this),this.handGestureController.onSwipe.remove(this.swipeDetected,this),this.game.time.events.remove(this.autoplayEvent),this.cancelTutorial(),void 0!==this.args.sounds&&void 0!==this.args.sounds.interact&&this.audioController.pauseAudio(this.args.sounds.interact),null==(t=this.followFingerSpriteFlyOut())&&(this.followFingerSprite.destroy(),this.followFingerSprite=null)),t?t.onComplete.add(function(){this.followFingerSprite.destroy(),this.followFingerSprite=null,this.destroy()},this):this.destroy()},this)}}]),t}(Phaser.Group));i.default=C},{"../prefabs/audio-controller":5,"../prefabs/counter":8,"../utils/container-util":32,"../utils/custom-png-sequences-renderer":33,"../utils/particles-util":34,"../utils/tweener":35,"../utils/util":36}],17:[function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e("../utils/container-util"),u=n(l),c=e("../utils/custom-png-sequences-renderer"),h=n(c),d=function(e){function t(e,i,n){a(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.initSignals(),r.containerName=n.container,r.getContainerInfo(),r.projectiles=[],r.gameDuration=n.gameDuration,r.initialTimeMargin=n.initialTimeMargin,r.endTimeMargin=n.endTimeMargin,r.failAni=void 0!==n.failAni?n.failAni:null,r.successAni=void 0!==n.successAni?n.successAni:null,r.triggered=!1,r.handGestureController=i,r.swipe="",r.failed=!1,r.createProjectiles(n.src,n.amount,n.direction),r}return r(t,e),s(t,[{key:"initSignals",value:function(){this.onSuccess=new Phaser.Signal,this.onFail=new Phaser.Signal}},{key:"getContainerInfo",value:function(){this.containerWidth=u.getContainerWidth(this.containerName),this.containerHeight=u.getContainerHeight(this.containerName),this.x=u.getContainerX(this.containerName),this.y=u.getContainerY(this.containerName)}},{key:"createInteractionArea",value:function(){this.handGestureController.onSwipe.add(function(e){-1!=e.indexOf("UP")&&(this.swipe="up",this.failed||this.flyUpProjectiles())},this)}},{key:"createProjectiles",value:function(e,t,i){for(var n=-1==e.indexOf(".png"),a=0;a<t;a++){if(n)var o=h.playPngSequence(this.game,e,this);else var o=new Phaser.Sprite(this.game,0,0,e);switch(o.anchor.set(.5),o.scale.y=this.containerHeight/o.height/t,o.scale.x=o.scale.y,o.x=this.containerWidth+Math.abs(o.width)/2+this.x,o.y=0==a?u.getYCenterWithinContainer(this.containerName):u.getRandomYWithinContainer(this.containerName)/t+this.y,i){case"inverse":o.scale.x*=-1;break;case"random":o.scale.x*=Math.floor(2*Match.random()-1);break;case"same":o.scale.x*=1;default:console.log("please set the projectile direction")}this.projectiles.push(o)}}},{key:"updateProjectiles",value:function(e){switch(e){case"up":for(var t=0;t<this.projectiles.length;t++){var i=this.projectiles[t],n=this.angle;this.game.add.tween(i).to({y:-1e3,angle:[n+=120]},1e3,Phaser.Easing.Linear.out,!0,100*t)}break;case"down":for(var t=0;t<this.projectiles.length;t++){var i=this.projectiles[t],n=this.angle;this.game.add.tween(i).to({y:this.game.global.windowHeight+1e3,angle:[n-=120]},1e3,Phaser.Easing.Linear.out,!0,100*t)}}}},{key:"hide",value:function(){this.alpha>0&&(this.alpha=0)}},{key:"show",value:function(){this.alpha<1&&(this.alpha=1),this.triggered||this.fly()}},{key:"fly",value:function(){this.triggered=!0,this.flyToCenterProjectiles(this.initialTimeMargin);var e=this.gameDuration-this.initialTimeMargin-this.endTimeMargin;this.game.time.events.add(this.initialTimeMargin,function(){this.createInteractionArea(),this.flySlowMoProjectiles(e)},this),this.game.time.events.add(e,function(){""==this.swipe&&(this.onFail.dispatch(this),this.flyStraightProjectiles(this.endTimeMargin),this.failed=!0)},this)}},{key:"flyToCenterProjectiles",value:function(e){for(var t=0;t<this.projectiles.length;t++){var i=this.projectiles[t];this.flyToCenter(i,e)}}},{key:"flyToCenter",value:function(e,t){e.tween&&this.game.tweens.remove(e.tween),e.tween=this.game.add.tween(e).to({x:this.containerWidth/2+Math.abs(e.width)/2+this.x},t,Phaser.Easing.Quadratic.In,!0,0)}},{key:"flySlowMoProjectiles",value:function(e){for(var t=0;t<this.projectiles.length;t++){var i=this.projectiles[t];this.flySlowMo(i,e)}}},{key:"flySlowMo",value:function(e,t){e.tween&&this.game.tweens.remove(e.tween),e.tween=this.game.add.tween(e).to({x:this.containerWidth/2+this.x},t,Phaser.Easing.Linear.None,!0,0)}},{key:"flyStraightProjectiles",value:function(e){for(var t=0;t<this.projectiles.length;t++){var i=this.projectiles[t];this.flyStraight(i,e)}}},{key:"flyStraight",value:function(e,t){e.tween&&this.game.tweens.remove(e.tween),e.tween=this.game.add.tween(e).to({x:this.x+.1*Math.abs(e.width)},t,Phaser.Easing.Linear.In,!0,0),e.tween.onComplete.add(function(e){if(e.alpha=0,null!=this.failAni){var t=h.playPngSequence(this.game,this.failAni,this);t.scale.y=1.8*e.height/t.height,t.scale.x=t.scale.y,t.x=this.x-.4*Math.abs(e.width),t.y=e.y-t.height/2}},this)}},{key:"flyUpProjectiles",value:function(){for(var e=0;e<this.projectiles.length;e++)this.flyUp(this.projectiles[e],0,this.endTimeMargin);this.onSuccess.dispatch(this)}},{key:"flyUp",value:function(e,t,i){e.tween&&this.game.tweens.remove(e.tween);var n=this.angle,a=e.y;this.game.add.tween(e).to({y:[a,-500],angle:[n+=120],x:this.x},i,Phaser.Easing.Linear.Out,!0,t)}},{key:"disable",value:function(){this.hide()}},{key:"enable",value:function(){this.show()}},{key:"autoDestroy",value:function(e){this.game.time.events.add(e,function(){this.destroy()},this)}}]),t}(Phaser.Group);i.default=d},{"../utils/container-util":32,"../utils/custom-png-sequences-renderer":33}],18:[function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e("../utils/container-util"),u=n(l),c=e("../utils/animations-util"),h=(n(c),e("../utils/custom-png-sequences-renderer.js")),d=(n(h),e("../utils/util")),f=n(d),g=function(e){function t(e,i){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return void 0!==i.OSsensitive&&1==i.OSsensitive&&(i.src=f.getDeviceOS()+"-"+i.src),n.args=i,n.initSignals(),void 0!==i.src&&""!=i.src?n.createButton(i):n.createInteractiveArea(i),n.button.inputEnabled=!0,n.button.input.useHandCursor=!0,n.button.events.onInputDown.add(function(){this.game.scale.setGameSize(document.body.clientWidth*window.devicePixelRatio,document.body.clientHeight*window.devicePixelRatio),this.game.scale.refresh(),this.game.state.start("boot",!0,!1),this.game.onSDKCall.dispatch()},n),n.game.world.bringToTop(n),n.hide(),n.anchor=[],n.anchor.x=n.args.anchor.x,n.anchor.y=n.args.anchor.y,n}return r(t,e),s(t,[{key:"createButton",value:function(e){this.button=new Phaser.Sprite(this.game,0,0,e.src),this.button.x-=this.button.width*this.args.anchor.x,this.button.y-=this.button.height*this.args.anchor.y,this.add(this.button),this.button.bringToTop(),u.fitInContainer(this,e.container,this.args.anchor.x,this.args.anchor.y)}},{key:"createInteractiveArea",value:function(e){var t=new Phaser.Graphics(this.game,0,0);t.beginFill(16777215,0),t.drawRect(-u.getContainerWidth(e.container)*this.args.anchor.x,-u.getContainerHeight(e.container)*this.args.anchor.y,u.getContainerWidth(e.container),u.getContainerHeight(e.container)),this.button=t,this.add(this.button),u.fitInContainer(this,e.container,this.args.anchor.x,this.args.anchor.y)}},{key:"initSignals",value:function(){this.onInteract=new Phaser.Signal}},{key:"show",value:function(){this.alpha<1&&(this.alpha=1),this.button.inputEnabled=!0}},{key:"hide",value:function(){this.alpha>0&&(this.alpha=0),this.button.inputEnabled=!1}},{key:"enable",value:function(){this.button.inputEnabled||(this.button.inputEnabled=!0)}},{key:"disable",value:function(){this.button.inputEnabled&&(this.button.inputEnabled=!1)}},{key:"fitInContainer",value:function(e){u.fitInContainer(this,e,this.anchor.x,this.anchor.y)}}]),t}(Phaser.Group);i.default=g},{"../utils/animations-util":31,"../utils/container-util":32,"../utils/custom-png-sequences-renderer.js":33,"../utils/util":36}],19:[function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=e("../utils/container-util"),c=n(u),h=e("../utils/custom-png-sequences-renderer"),d=n(h),f=e("../utils/particles-util"),g=n(f),p=e("../prefabs/custom-text"),m=(function(e){e&&e.__esModule}(p),function(e){function t(e,i,n,r){a(this,t);var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.initSignals(),s.symbolArgs=n,s.dockArgs=n.counter,void 0!==s.symbolArgs.sounds&&(s.audioController=r),s.containerName=n.container,s.getContainerInfo(),s.gameDuration=n.gameDuration,s.initialTimeMargin=n.initialTimeMargin,s.endTimeMargin=n.endTimeMargin,s.interactDuration=s.gameDuration-s.initialTimeMargin-s.endTimeMargin,s.failAni=void 0!==n.failAni?n.failAni:null,s.successAni=void 0!==n.successAni?n.successAni:null,s.handGestureController=i,s.initialised=!1,s.clickTiming="bad",s.particleNum={good:5,perfect:10},s.result="miss",s.init(),s.controlPerfectHittingTiming(),s}return r(t,e),l(t,[{key:"init",value:function(){this.initialised||(this.createDock(),this.symbol=this.createSymbol(),this.createInteractiveArea(),this.initialised=!0,this.add(this.symbol),this.symbol.bringToTop(),this.fly())}},{key:"initSignals",value:function(){this.onSuccess=new Phaser.Signal,this.onFail=new Phaser.Signal}},{key:"getContainerInfo",value:function(){this.containerWidth=c.getContainerWidth(this.containerName),this.containerHeight=c.getContainerHeight(this.containerName)}},{key:"controlPerfectHittingTiming",value:function(){this.game.time.events.add(this.initialTimeMargin,function(){this.clickTiming="good",this.game.time.events.add(this.interactDuration/2,function(){this.clickTiming="perfect",this.game.time.events.add(this.interactDuration/2,function(){this.clickTiming="bad",this.feedbackText.alpha=1,this.animateText()},this)},this)},this)}},{key:"createInteractiveArea",value:function(){"tap"==this.symbolArgs.typeOfInteraction&&this.createTapInteractiveArea()}},{key:"createTapInteractiveArea",value:function(){var e=this.symbolArgs.interactionContainer,t=new Phaser.Graphics(this.game,0,0);t.beginFill(14554186,0),t.drawRect(c.getContainerX(e),c.getContainerY(e),c.getContainerWidth(e),c.getContainerHeight(e)),t.worldX=c.getContainerX(e),t.worldY=c.getContainerY(e),t.worldWidth=c.getContainerWidth(e),t.worldHeight=c.getContainerHeight(e),this.button=t,this.add(this.button);this.button.inputEnabled=!0,this.button.input.useHandCursor=!0,this.button.events.onInputDown.add(function(){switch(this.clickTiming){case"bad":this.result="miss";break;case"good":this.result="good",this.button.inputEnabled=!1,this.feedbackText.text=this.result;break;case"perfect":this.result="perfect",this.button.inputEnabled=!1,this.feedbackText.text=this.result;break;default:this.result="miss"}},this)}},{key:"createSwipeInteractiveArea",value:function(){this.handGestureController.onSwipe.add(function(e){-1!=e.indexOf("UP")&&(this.swipe="up",this.failed||this.flyUpSymbol())},this)}},{key:"createSymbol",value:function(){if(this.symbolArgs.isAnimation){var e=d.playPngSequence(this.game,this.symbolArgs.src,this);c.fitInContainer(e,this.symbolArgs.htmlTag,.5,.5)}else{var e=new Phaser.Sprite(this.game,0,0,this.symbolArgs.src);c.fitInContainer(e,this.symbolArgs.htmlTag,.5,.5),this.add(e)}return e.anchor.set(.5),e.x=this.containerWidth+Math.abs(e.width)/2+this.x,e.y=c.getYCenterWithinContainer(this.containerName),e}},{key:"createDock",value:function(){var e=new Phaser.Sprite(this.game,0,0,this.dockArgs.backgroundSrc);c.fitInContainer(e,this.dockArgs.htmlTag,.5,.5);var t=new Phaser.Sprite(this.game,0,0,this.dockArgs.iconSrc);c.fitInContainer(t,this.dockArgs.targetTag,.5,.5),this.add(e),this.add(t),void 0!==this.symbolArgs.textFeedback&&(this.generateFeedbackText(this.result),this.feedbackText.alpha=0)}},{key:"fly",value:function(){var e=c.getXCenterWithinContainer(this.dockArgs.targetTag),t=this.symbol.scale.x;this.game.add.tween(this.symbol).to({x:e},this.initialTimeMargin+this.interactDuration,Phaser.Easing.Linear.None,!0,0).onComplete.add(function(){this.game.add.tween(this.symbol.scale).to({x:[1.1*t,0],y:[1.1*t,0]},100,Phaser.Easing.Linear.Out,!0,0).onComplete.add(function(){var e=this.createSymbol();this.game.add.existing(e);var i=c.getWorldPos(this.game,this.symbol.world.x,this.symbol.world.y);e.x=i.x,e.y=i.y,this.symbolFlyToDestination(e,t),this.symbol.destroy(),"miss"!==this.result?(void 0!==this.symbolArgs.successEffect&&this.playEffect(this.symbolArgs.successEffect),("object"===s(this.successConsequences)||this.successConsequences instanceof Object)&&(this.successConsequences=this.symbolArgs.successConsequences[this.result]),this.onSuccess.dispatch(this),this.feedbackText.alpha=1,this.animateText(),void 0!==this.symbolArgs.sounds&&void 0!==this.symbolArgs.sounds.hit&&this.playSoundEffect("hit")):(void 0!==this.symbolArgs.failEffect&&this.playEffect(this.symbolArgs.failEffect),("object"===s(this.failConsequences)||this.failConsequences instanceof Object)&&(this.failConsequences=this.symbolArgs.failConsequences[this.result]),this.onFail.dispatch(this),void 0!==this.symbolArgs.sounds&&void 0!==this.symbolArgs.sounds.miss&&this.playSoundEffect("miss"))},this)},this)}},{key:"playSoundEffect",value:function(e){var t=0;void 0!==this.symbolArgs.sounds&&void 0!==this.symbolArgs.sounds[e]&&(this.audioController.playAudio(this.symbolArgs.sounds[e]+"_"+t,PiecSettings.assetsDir+this.symbolArgs.sounds[e]),t++)}},{key:"symbolFlyToDestination",value:function(e,t){e.sendToBack(),e.scale.x=t,e.scale.y=t;var i=c.getXCenterWithinContainer(this.dockArgs.iconFlyToContainer),n=c.getYCenterWithinContainer(this.dockArgs.iconFlyToContainer);this.game.add.tween(e).to({x:i,y:n},this.endTimeMargin,Phaser.Easing.Linear.Out,!0,0),this.game.add.tween(e.scale).to({x:.2*t,y:.2*t},this.endTimeMargin,Phaser.Easing.Linear.Out,!0,0).onComplete.add(function(){e.alpha=0,e.destroy()},this)}},{key:"generateFeedbackText",value:function(e){e=e.toUpperCase();var t,i="bold",n=PiecSettings.fontFamily,a=[PiecSettings.fontColor],o=null,r=null,s=null,l=.5,u=.5;if(void 0!=this.symbolArgs.textFeedback.fontStyle){var h=this.symbolArgs.textFeedback.fontStyle;i=h.fontWeight,t=c.getContainerHeight(this.symbolArgs.textFeedback.container),n=h.fontFamily,a=h.color,o=h.stroke||null,r=h.strokeThickness||null,s=h.shadow||null,l=h.anchor.x,u=h.anchor.y}var d={font:i+" "+t+"px "+n+","+PiecSettings.genericFontFamily,align:"center"};this.feedbackText=new Phaser.Text(this.game,0,0,e,d),c.fitInContainer(this.feedbackText,this.symbolArgs.textFeedback.container,.5,.5),this.add(this.feedbackText),this.feedbackText.anchor.set(l,u),this.feedbackText.align="center",this.feedbackText.initialScale=this.feedbackText.scale.x,this.feedbackText.fill="black";var f=this.feedbackText.context.createLinearGradient(0,0,0,this.height);if(void 0!==a&&a.length>0)for(var g=0;g<a.length;g++){var p=g/a.length;f.addColorStop(p,a[g])}if(this.feedbackText.fill=f,null!==o&&(this.feedbackText.stroke=o),void 0!==r&&(this.feedbackText.strokeThickness=r),null!==s){var m=s;this.feedbackText.setShadow(m.x,m.y,m.color,m.blur)}}},{key:"animateText",value:function(){c.getContainerY(this.dockArgs.iconFlyToContainer);this.game.add.tween(this.feedbackText).to({alpha:0},800,Phaser.Easing.Linear.None,!0,0)}},{key:"hide",value:function(){this.alpha>0&&(this.alpha=0)}},{key:"show",value:function(){this.alpha<1&&(this.alpha=1)}},{key:"playEffect",value:function(e){var t=c.getXCenterWithinContainer(this.dockArgs.iconFlyToContainer),i=c.getYCenterWithinContainer(this.dockArgs.iconFlyToContainer);if(null!=this.game)switch(e){case"explodeInCircle":g.particleExplosion(this.game,this.symbolArgs.particles.src,this.symbolArgs.particles.htmlTag,this.dockArgs.iconFlyToContainer,t,i,this.particleNum[this.result]);break;case"burst":g.particleBurst(this.game,this.symbolArgs.particles.src,this.symbolArgs.particles.htmlTag,t,i,10);break;case"spawn":this.particles.push.apply(this.particles,g.particleSpawn(this.game,this.symbolArgs.particles.src,this.symbolArgs.particles.htmlTag,t,i,1));break;case"shootLeft":g.particleShoot(this.game,this.symbolArgs.particles.src,this.symbolArgs.particles.htmlTag,t,i,15,-1,1);break;case"spawnAndFade":var n=g.particleSpawn(this.game,this.symbolArgs.particles.src,this.symbolArgs.particles.htmlTag,t,i,1,30)[0],a=n.x,o=n.y;this.game.add.tween(n).to({x:[a+.1*n.width*(Math.random()>.5?1:-1),a+.1*n.width*(Math.random()>.5?1:-1)],y:o-.75*n.height,alpha:[1,0]},700,Phaser.Easing.Quadratic.Out,!0,0);var r=n.scale.x;this.game.add.tween(n.scale).to({x:[1.15*r,.9*r],y:[1.15*r,.9*r]},700,Phaser.Easing.Back.Out,!0,0);break;case"glitterRain":g.particleRain(this.game,this.symbolArgs.particles.src,this.symbolArgs.particles.htmlTag,this.symbolArgs.particles.htmlTagGoal,t,i,15,0,10);break;case"glitterBurst":g.particleRain(this.game,this.symbolArgs.particles.src,this.symbolArgs.particles.htmlTag,this.symbolArgs.particles.htmlTagGoal,t,i,15,10,40);break;default:g.particleBurst(this.game,this.symbolArgs.particles.src,this.symbolArgs.particles.htmlTag,t,i,10)}}},{key:"disable",value:function(){this.hide()}},{key:"enable",value:function(){this.show()}},{key:"autoDestroy",value:function(e){console.log("autoDestroy")}}]),t}(Phaser.Group));i.default=m},{"../prefabs/custom-text":11,"../utils/container-util":32,"../utils/custom-png-sequences-renderer":33,"../utils/particles-util":34}],20:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(t){n(this,e),this.container=t,this.video=document.getElementById(t);var i=document.getElementsByTagName("source");0==i.length?this.source=document.createElement("source"):this.source=i[0],this.video.appendChild(this.source),this.video.controls=!1,this.muted=!0,this.initSignals()}return a(e,[{key:"initSignals",value:function(){this.onComplete=new Phaser.Signal,this.onLoop=new Phaser.Signal}},{key:"play",value:function(e,t){if(e.includes(".gif")){if(void 0==this.gifElem){var i=document.createElement("img");i.setAttribute("src",e),document.getElementById("gifBg").appendChild(i),this.gifElem=i}}else if(void 0==this.videoName||this.videoName!=e){this.videoName=e,this.source.setAttribute("src",e),this.video.load(),this.video.play(),this.video.currentTime=0,this.video.endTime=0,this.video.muted=this.muted;var n=this;this.video.addEventListener("loadeddata",function(){n.initVideoArgs(t)})}else this.initVideoArgs(t),this.video.play()}},{key:"update",value:function(){this.video.muted=this.muted,this.videoEnded()&&(this.video.shouldLoop?(this.video.currentTime=this.video.initialTime,this.video.play(),this.onLoop.dispatch()):(this.video.paused||this.video.pause(),this.onComplete.dispatch())),!this.video.paused&&this.videoEnded()&&(this.video.pause(),this.onComplete.dispatch())}},{key:"videoEnded",value:function(){return this.video.ended||0!=this.video.endTime&&this.video.currentTime>=this.video.endTime}},{key:"initVideoArgs",value:function(e){void 0!==e&&(void 0!==e.from&&void 0!==e.to?(this.video.initialTime=e.from,this.video.currentTime=e.from,this.video.endTime=void 0!==e.to?e.to:0):void 0!==e.from&&(this.video.initialTime=e.from,this.video.currentTime=e.from,this.video.endTime=0),void 0!==e.loop&&"boolean"==typeof e.loop?this.video.shouldLoop=e.loop:this.video.shouldLoop=!1)}},{key:"getCurrentTime",value:function(){return void 0!==this.gifElem?0:this.video.currentTime}},{key:"unmute",value:function(){this.muted=!1}},{key:"mute",value:function(){this.muted=!0}},{key:"pause",value:function(){this.video.pause(),this.pausedCurrentTime=this.video.currentTime}},{key:"isPaused",value:function(){return this.video.paused}}]),e}();i.default=o},{}],21:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e("../prefabs/audio-controller"),r=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t){n(this,e),this.game=t,this.audioController=new r.default,this.canPlay=!1}return a(e,[{key:"initAudio",value:function(e,t){this.audioController.initAudio(e,t)}},{key:"enableAudio",value:function(){this.canPlay=!0}},{key:"pauseAllAudio",value:function(){this.audioController.muteAll()}},{key:"unmuteAllAudio",value:function(){this.audioController.unmuteAll()}},{key:"playAudio",value:function(e,t,i){this.canPlay&&this.audioController.play(e,t,i)}},{key:"pauseAudio",value:function(e){this.audioController.pause(e)}},{key:"fadeOutAudio",value:function(e){this.audioController.fadeOut(e)}},{key:"resetToDefaultAudioList",value:function(e){if(void 0!==e&&null!=e)for(var t=0;t<e.length;t++)e[t].played=!1}},{key:"resetAudio",value:function(e){if(void 0!==e&&null!=e)for(var t=0;t<e.length;t++)e[t].played&&!e[t].triggerOnce&&(this.audioController.pause(e[t].tag),e[t].played=!1)}},{key:"update",value:function(e,t){if(void 0!==t&&null!=t)for(var i=0;i<t.length;i++){var n=this.checkIfShouldBeEnabled(t[i],e);if(null!=n&&!t[i].played){if(n){var a=t[i].tag,o=PiecSettings.assetsDir+t[i].src,r={loop:t[i].loop,volume:t[i].volume};this.audioController.play(a,o,r)}else this.audioController.pause(t[i].tag);void 0!==t[i].triggerOnce&&this.canPlay&&(t[i].played=!0)}}}},{key:"checkIfShouldBeEnabled",value:function(e,t){return void 0!==e.at&&t>e.at?!(!e.play||!this.canPlay):null}}]),e}();i.default=s},{"../prefabs/audio-controller":5}],22:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=e("../prefabs/collectible-controller"),r=function(e){return e&&e.__esModule?e:{default:e}}(o),s=function(){function e(t){n(this,e),this.game=t,this.initSignals(),this.collectibleController=new r.default(this.game),this.collectibleList=[],this.collectibleListFired=[],this.setupController()}return a(e,[{key:"initSignals",value:function(){this.onHudCreate=new Phaser.Signal,this.onCollectUpdate=new Phaser.Signal}},{key:"setupController",value:function(){
this.collectibleController.onHudCreate.add(function(e,t){this.onHudCreate.dispatch(e,t)},this),this.collectibleController.onCollectUpdate.add(function(e,t){this.onCollectUpdate.dispatch(e,t),this.variablesController&&this.variablesController.applyConsequences(this.collectibleController.getCollectible(e).consequences)},this)}},{key:"setCollectibleAmount",value:function(e,t){var i=this.collectibleController.getCollectible(e);null!=i&&i.setCollectibleAmount(t)}},{key:"update",value:function(e,t,i){if(this.variablesController||(this.variablesController=t),void 0!==i){this.collectibleList!=i&&(this.collectibleList=i,this.collectibleListFired=[]);for(var n=0;n<i.length;n++){var a=i[n].tag;!this.collectibleListFired[n]&&t.evaluateConditions(i[n].conditions)&&this.checkIfCollectibleShouldBeFired(i[n],e)&&(this.collectibleListFired[n]=!0,void 0!==i[n].spawn&&i[n].spawn?this.collectibleController.getCollectible(a).spawnCollectibles({amount:i[n].amount,lifetime:1e3*(i[n].to-i[n].from),spawnArea:i[n].htmlTag}):this.collectibleController.getCollectible(a).increaseCollectibleAmount(i[n].amount,i[n].spawn),this.collectibleController.getCollectible(a).consequences=i[n].consequences)}}}},{key:"checkIfCollectibleShouldBeFired",value:function(e,t){return void 0!==e.from&&t>=e.from}}]),e}();i.default=s},{"../prefabs/collectible-controller":6}],23:[function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=e("../prefabs/custom-sprite"),l=a(s),u=e("../prefabs/custom-text"),c=a(u),h=e("../prefabs/cta-button"),d=a(h),f=e("../prefabs/retry-button"),g=a(f),p=e("../utils/container-util"),m=(n(p),e("../utils/util")),v=(n(m),e("../utils/tweener")),y=n(v),b=function(){function e(t){o(this,e),this.game=t,this.hudObjectsLayer=new Phaser.Group(this.game),this.initHudObjects()}return r(e,[{key:"addHudObject",value:function(e,t){this.hudObjects[e]=t,this.hudObjectsLayer.add(t)}},{key:"initHudObjects",value:function(){if(this.hudObjects=[],void 0!=PiecSettings.hudElements&&null!=PiecSettings.hudElements){for(var e in PiecSettings.hudElements)if(PiecSettings.hudElements.hasOwnProperty(e)){var t=PiecSettings.hudElements[e];void 0!==t.type&&"cta"==t.type?this.hudObjects[e]=new d.default(this.game,{src:t.src,container:t.htmlTag,anchor:t.anchor,OSsensitive:t.OSsensitive}):void 0!==t.type&&"retry"==t.type?this.hudObjects[e]=new g.default(this.game,{src:t.src,container:t.htmlTag,anchor:t.anchor,OSsensitive:t.OSsensitive}):void 0!==t.src?this.hudObjects[e]=new l.default(this.game,{src:t.src,container:t.htmlTag,anchor:t.anchor,OSsensitive:t.OSsensitive}):void 0!==t.text&&(this.hudObjects[e]=new c.default(this.game,{text:t.text,container:t.htmlTag,anchor:t.anchor,style:t.style,autolocalise:t.autolocalise})),this.hudObjectsLayer.add(this.hudObjects[e])}this.game.world.bringToTop(this.hudObjectsLayer)}}},{key:"resetToDefaultHudList",value:function(e){if(void 0!==e&&null!=e)for(var t=0;t<e.length;t++)e[t].played=!1}},{key:"resetHudList",value:function(e){if(void 0!==e&&null!=e)for(var t=0;t<e.length;t++)e[t].played&&!e[t].triggerOnce&&(e[t].played=!1)}},{key:"update",value:function(e,t,i,n){if(void 0!==n&&null!=n)for(var a=0;a<n.length;a++){var o=n[a].tag;if(!n[a].played&&null!=this.hudObjects[o]){var r=this.checkIfHudShouldBeEnabled(n[a],e,t),s=this.checkIfHasAnimationEffects(n[a],e,t),l=this.checkIfHudShouldMove(n[a],e,t);i.evaluateConditions(n[a].conditions)&&(this.game.world.bringToTop(this.hudObjectsLayer),s&&(this.animate(this.hudObjects[o],n[a].effect),-1!=n[a].effect.indexOf("In")&&"function"==typeof this.hudObjects[o].enable?this.hudObjects[o].enable():-1!=n[a].effect.indexOf("Out")&&"function"==typeof this.hudObjects[o].disable&&this.hudObjects[o].disable()),null!=r&&(r?this.hudObjects[o].show():this.hudObjects[o].hide()),l&&this.moveToContainer(this.hudObjects[o],n[a].effect,n[a].htmlTag,n[a].duration,n[a].easing),(null!=r||l||s)&&(n[a].played=!0,i.applyConsequences(n[a].consequences)))}}}},{key:"checkIfHudShouldMove",value:function(e,t,i){return void 0!==e.htmlTag&&void 0!==e.at&&t>=e.at&&e.at>=i}},{key:"checkIfHasAnimationEffects",value:function(e,t,i){return void 0!==e.effect&&void 0!==e.at&&t>=e.at&&e.at>=i}},{key:"checkIfHudShouldBeEnabled",value:function(e,t,i){return void 0!==e.at&&t>=e.at&&void 0!==e.show&&e.at>=i?!!e.show:null}},{key:"moveToContainer",value:function(e,t,i,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Phaser.Easing.Linear.None;this.removeTween(e),void 0==n&&(n=600),e.currentContainer!=i&&(e.alpha>0||void 0!==t&&-1!=t.indexOf("fade"))?(e.currentContainer=i,void 0!==e.text?e.tween=y.moveToContainer(e,i,0,n,a,void 0,void 0,!0):e.tween=y.moveToContainer(e,i,0,n,a)):e.fitInContainer(i)}},{key:"animate",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;switch(this.removeTween(e),t){case"fadeIn":-1==i&&(i=300),e.tween=y.fadeIn(e,0,i,Phaser.Easing.Quadratic.InOut);break;case"fadeOut":-1==i&&(i=300),e.tween=y.fadeOut(e,0,i,Phaser.Easing.Quadratic.InOut);break;case"tap":e.tween=y.tap(e,0,0,700,Phaser.Easing.Quadratic.InOut);break;case"tapDown":e.tween=y.tap(e,-130,0,700,Phaser.Easing.Quadratic.InOut);break;case"quickTap":e.tween=y.quickTap(e,0,300,Phaser.Easing.Quadratic.InOut);break;case"slideInDown":e.tween=y.slideInDown(e,0,300,Phaser.Easing.Quadratic.InOut);break;case"slideInDownBack":e.tween=y.slideInDown(e,0,500,Phaser.Easing.Back.Out);break;case"slideInUp":e.tween=y.slideInUp(e,0,300,Phaser.Easing.Quadratic.InOut);break;case"slideInUpBack":e.tween=y.slideInUp(e,0,500,Phaser.Easing.Back.Out);break;case"slideInLeft":e.tween=y.slideInLeft(e,0,300,Phaser.Easing.Quadratic.InOut);break;case"slideInLeftBack":e.tween=y.slideInLeft(e,0,500,Phaser.Easing.Back.Out);break;case"slideInRight":e.tween=y.slideInRight(e,0,300,Phaser.Easing.Quadratic.InOut);break;case"slideInRightBack":e.tween=y.slideInRight(e,0,500,Phaser.Easing.Back.Out);break;case"pulse":e.tween=y.pulse(e,0,300,Phaser.Easing.Quadratic.InOut);break;case"pulseSlow":e.tween=y.pulse(e,0,500,Phaser.Easing.Quadratic.InOut);break;case"swipe":e.tween=y.swipe(e,0,600,Phaser.Easing.Quadratic.InOut,600);break;case"smallSwipeUpDown":e.tween=y.smallSwipeUpDown(e,0,600,Phaser.Easing.Quadratic.InOut);break;case"scaleIn":e.tween=y.scaleIn(e,0,900,Phaser.Easing.Elastic.Out);break;case"scaleOut":e.tween=y.scaleOut(e,0,500,Phaser.Easing.Elastic.In);break;case"rubberBand":e.tween=y.rubberBand(e,0,1e3,Phaser.Easing.Elastic.Out)}}},{key:"removeTween",value:function(e){void 0!==e.tween&&null!=e.tween&&this.game.tweens.remove(e.tween)}}]),e}();i.default=b},{"../prefabs/cta-button":9,"../prefabs/custom-sprite":10,"../prefabs/custom-text":11,"../prefabs/retry-button":18,"../utils/container-util":32,"../utils/tweener":35,"../utils/util":36}],24:[function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=e("../prefabs/interactive-element"),l=a(s),u=e("../prefabs/hand-gesture-controller"),c=a(u),h=e("../prefabs/projectile-game"),d=a(h),f=e("../prefabs/powerup-game"),g=a(f),p=e("../prefabs/hiddenobject-game"),m=a(p),v=e("../prefabs/rhythm-game"),y=a(v),b=e("../utils/video-playable-util"),w=n(b),P=e("../utils/util"),C=n(P),S=function(){function e(t,i){o(this,e),this.game=t,this.videoPlayableStateController=i,this.currentInteractions=null,this.interactiveElements=[],this.handGestureController=new c.default(this.game),this.initSignals(),this.setupController()}return r(e,[{key:"initSignals",value:function(){this.onInteract=new Phaser.Signal,this.onHudCreate=new Phaser.Signal}},{key:"setupController",value:function(){}},{key:"update",value:function(e,t,i){if(this.handGestureController.update(),this.currentInteractions!=i&&(this.currentInteractions=i,this.clearCurrentInteractiveElements(),this.createInteractiveElements(e,i,t)),void 0!=i&&null!=i)for(var n=0;n<i.length;n++){var a=i[n];this.checkIfInteractionShouldBeEnabled(a,e)&&t.evaluateConditions(i[n].conditions)?this.interactiveElements.length>0&&this.interactiveElements[n].enable():this.interactiveElements.length>0&&this.interactiveElements[n].disable()}}},{key:"areThereEnabledInteractions",value:function(e,t,i){if(void 0==i||null==i)return!1;for(var n=0;n<i.length;n++){var a=i[n];if(this.checkIfInteractionShouldBeEnabled(a,e)&&t.evaluateConditions(i[n].conditions))return!0}return!1}},{key:"clearCurrentInteractiveElements",value:function(){for(var e=[],t=this.interactiveElements.length,i=0;i<t;i++)this.elementShouldPersist(this.interactiveElements[i])?e.push(this.interactiveElements[i]):(this.interactiveElements[i].disable(),this.interactiveElements[i].autoDestroy(100));this.interactiveElements=e}},{key:"elementShouldPersist",value:function(e){if(void 0!=this.currentInteractions&&null!=this.currentInteractions)for(var t=0;t<this.currentInteractions.length;t++)if(this.currentInteractions[t].typeOfInteraction==e.tag&&this.typeOfInteractionIsAMiniGame(this.currentInteractions[t].typeOfInteraction))return!0;return!1}},{key:"interactiveElementMiniGameAlreadyExists",value:function(e){if(void 0!=this.interactiveElements&&null!=this.interactiveElements)for(var t=0;t<this.interactiveElements.length;t++)if(this.interactiveElements[t].tag==e&&this.typeOfInteractionIsAMiniGame(e))return this.interactiveElements[t];return null}},{key:"calculateDuration",value:function(e,t){return 1e3*(w.timeOrFramerateInSeconds(t)-w.timeOrFramerateInSeconds(e))}},{key:"createInteractiveElements",value:function(e,t,i){if(void 0!=t&&null!=t)for(var n=0;n<t.length;n++){var a,o=t[n],r=0,s=0;if(void 0!==o.to?(a=this.calculateDuration(o.from,o.to),r=a):a=null,this.typeOfInteractionIsAMiniGame(o.typeOfInteraction)){if("minigame"==o.typeOfInteraction){var u=PiecSettings.minigames[o.gameTag],c={initialTimeMargin:u.initialTimeMargin,endTimeMargin:u.endTimeMargin,gameDuration:a,container:o.htmlTag};r-=u.initialTimeMargin+u.endTimeMargin,s+=u.initialTimeMargin;var h=new d.default(this.game,this.handGestureController,C.JSONmerge(u,c));this.initMinigame(o,h,n,i)}else if(this.typeOfInteractionIsAPowerupGame(o.typeOfInteraction)){var f=this.interactiveElementMiniGameAlreadyExists(o.typeOfInteraction);if(null==f){var u=PiecSettings.minigames[o.typeOfInteraction],c=u;c.currentStateAutoPlay=this.videoPlayableStateController.currentState.autoplay.after;var h=new g.default(this.game,this.handGestureController,this.videoPlayableStateController.videoPlayableAudioController,this.videoPlayableStateController.videoPlayableHudController,c);this.initMinigame(o,h,n,i),h.onHudCreate.add(function(e,t){this.onHudCreate.dispatch(e,t)},this)}else f.reinitStateForPersistingInstance()}else if(this.typeOfInteractionIsAHiddenObjectGame(o.typeOfInteraction)){var u=PiecSettings.minigames[o.typeOfInteraction],c=u;c.currentStateAutoPlay=this.videoPlayableStateController.currentState.autoplay.after;var h=new m.default(this.game,this.videoPlayableStateController.videoPlayableAudioController,this.videoPlayableStateController.videoPlayableHudController,c);this.initMinigame(o,h,n,i)}else if(this.typeOfInteractionIsARhythmGame(o.typeOfInteraction)){var u=PiecSettings.minigames[o.typeOfInteraction],c={initialTimeMargin:u.initialTimeMargin,endTimeMargin:u.endTimeMargin,gameDuration:a,container:o.htmlTag,successConsequences:o.successConsequences};r-=u.initialTimeMargin+u.endTimeMargin,s+=u.initialTimeMargin;var h=new y.default(this.game,this.handGestureController,C.JSONmerge(u,c),this.videoPlayableStateController.videoPlayableAudioController);this.initMinigame(o,h,n,i)}}else{var p="onInputDown";"release"==o.typeOfInteraction&&(p="onInputUp");var v=new l.default(this.game,this.handGestureController,{src:o.src,container:o.htmlTag,onInteractEvent:p,typeOfInteraction:o.typeOfInteraction});v.onSuccess=o.onSuccess,v.consequences=o.consequences,this.game.add.existing(v),this.interactiveElements.push(v),v.hide(),v.disable(),void 0!==v&&v.onInteract.add(function(e){"pauseResume"==e.args.typeOfInteraction?this.onInteract.dispatch(null,null):(void 0!=e.onSuccess&&null!=e.onSuccess||console.log("%c  ERROR: No onSuccess has been defined for this "+e.args.typeOfInteraction+" event","background: #222; color:"+C.getRandomColor()),this.onInteract.dispatch(e.onSuccess,e.consequences))},this)}if(this.interactionHasTimer(o)){var b=s+this.calculateDuration(e,o.from);null!=this.videoPlayableStateController.videoPlayableTimer&&this.videoPlayableStateController.videoPlayableTimer.startTimer(b,r/1e3)}}}},{key:"typeOfInteractionIsAMiniGame",value:function(e){return!("tap"==e||"release"==e||"pauseResume"==e)}},{key:"typeOfInteractionIsAPowerupGame",value:function(e){return void 0!==PiecSettings.minigames[e]&&"powerup-minigame"==PiecSettings.minigames[e].type}},{key:"typeOfInteractionIsAHiddenObjectGame",value:function(e){return void 0!==PiecSettings.minigames[e]&&"hidenobject-minigame"==PiecSettings.minigames[e].type}},{key:"typeOfInteractionIsARhythmGame",value:function(e){return void 0!==PiecSettings.minigames[e]&&"rhythm-minigame"==PiecSettings.minigames[e].type}},{key:"initMinigame",value:function(e,t,i,n){t.successConsequences=e.successConsequences,t.successScript=e.onSuccess,t.failConsequences=e.failConsequences,t.failScript=e.onFail,t.tag=e.typeOfInteraction,this.game.add.existing(t),this.interactiveElements.push(t),t.hide(),t.disable(),t.onSuccess.add(function(e){var i,a,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;void 0!==e.successConsequences&&(i=n.applyConsequences(e.successConsequences)),void 0!==e.successScript&&(a=null!=o&&"string"!=typeof t.successScript?e.successScript[o]:e.successScript,this.onInteract.dispatch(a,i)),t.disable()},this),t.onFail.add(function(e){var i,a;t.disable(),void 0!==e.failConsequences&&(i=n.applyConsequences(e.failConsequences)),void 0!==e.failScript&&(a=e.failScript,this.onInteract.dispatch(a,i))},this)}},{key:"interactionHasTimer",value:function(e){return void 0!==e.timer&&e.timer}},{key:"checkIfInteractionShouldBeEnabled",value:function(e,t){return!(void 0!==w.timeOrFramerateInSeconds(e.to)&&t>w.timeOrFramerateInSeconds(e.to))&&(void 0!==w.timeOrFramerateInSeconds(e.from)&&t>=w.timeOrFramerateInSeconds(e.from))}}]),e}();i.default=S},{"../prefabs/hand-gesture-controller":12,"../prefabs/hiddenobject-game":13,"../prefabs/interactive-element":14,"../prefabs/powerup-game":16,"../prefabs/projectile-game":17,"../prefabs/rhythm-game":19,"../utils/util":36,"../utils/video-playable-util":37}],25:[function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function a(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=e("../prefabs/video-playable-interactive-elements-controller"),l=a(s),u=e("../prefabs/video-playable-collectible-controller"),c=a(u),h=e("../prefabs/video-playable-audio-controller"),d=a(h),f=e("../prefabs/video-controller"),g=a(f),p=e("../prefabs/video-playable-hud-controller"),m=a(p),v=e("../prefabs/video-playable-variables-controller"),y=a(v),b=e("../prefabs/video-playable-timer"),w=a(b),P=e("../utils/video-playable-util"),C=n(P),S=e("../utils/util.js"),k=n(S),x=function(){function e(t,i,n,a,r){o(this,e),this.game=t,this.initialState=n,this.scripts=a,this.firstInteraction=!1,this.paused=!1,this.videoController=new g.default(i),this.videoPlayableAudioController=new d.default(this.game),this.interactiveElementsController=new l.default(this.game,this),this.videoPlayableCollectibleController=new c.default(this.game),this.videoPlayableHudController=new m.default(this.game),this.videoPlayableVariablesController=new y.default(r),this.videoPlayableTimer=null!=document.getElementById("video-playable-timer")?new w.default(this.game):null,this.currentState=this.initialState,this.initSignals(),this.setupController()}return r(e,[{key:"initSignals",value:function(){this.onStateChange=new Phaser.Signal,this.onPlayableComplete=new Phaser.Signal}},{key:"setupController",value:function(){this.videoController.onLoop.add(function(){this.videoPlayableHudController.resetHudList(this.currentState.hud),this.videoPlayableAudioController.resetAudio(this.currentState.audios)},this),this.videoController.onComplete.add(function(){this.currentStateHasDirectAutoplay()&&this.autoplay(),this.currentStateIsTheEnd()&&this.onPlayableComplete.dispatch()},this),this.game.input.onUp.add(function(){this.firstInteraction||(this.firstInteraction=!0,this.game.time.events.add(500,function(){this.playAudio(),this.videoController.unmute()},this))},this),this.videoPlayableCollectibleController.onHudCreate.add(function(e,t){this.videoPlayableHudController.addHudObject(e,t)},this),this.interactiveElementsController.onHudCreate.add(function(e,t){this.videoPlayableHudController.addHudObject(e,t)},this),this.interactiveElementsController.onInteract.add(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null!=e&&this.transitionToState(e),null!=t&&this.videoPlayableVariablesController.applyConsequences(t),null==e&&null==t&&(this.videoController.isPaused()?this.videoController.resume():this.videoController.pause())},this),this.videoPlayableCollectibleController.onCollectUpdate.add(function(e,t){this.videoPlayableVariablesController.setVariable(e,t)},this),this.videoPlayableVariablesController.onVariableUpdate.add(function(e,t){this.videoPlayableCollectibleController.setCollectibleAmount(e,t)},this)}},{key:"update",value:function(){this.paused||(this.videoController.update(),this.interactiveElementsController.update(this.getVideoControllerCurrentTime(),this.videoPlayableVariablesController,this.currentState.interactions),this.videoPlayableHudController.update(this.getVideoControllerCurrentTime(),this.currentState.from,this.videoPlayableVariablesController,this.currentState.hud),this.videoPlayableCollectibleController.update(this.getVideoControllerCurrentTime(),this.videoPlayableVariablesController,this.currentState.collectibles),this.videoPlayableAudioController.update(this.getVideoControllerCurrentTime(),this.currentState.audios))}},{key:"getVideoControllerCurrentTime",value:function(){return Math.max(this.currentState.from,this.videoController.getCurrentTime())}},{key:"transitionToState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!this.paused){null!=this.videoPlayableTimer&&this.videoPlayableTimer.stopTimer(),""!=e&&(this.currentState=this.scripts[e],this.currentState.keyName=e),null==this.currentState&&console.log("%c  ERROR: '"+e+"' video section doesn't exist","background: #222; color:"+k.getRandomColor()),this.videoPlayableHudController.resetToDefaultHudList(this.currentState.hud),this.videoPlayableAudioController.resetToDefaultAudioList(this.currentState.audios);var t=PiecSettings.assetsDir+this.currentState.video;"responsive"==PiecSettings.videoOrientation&&(t=PiecSettings.assetsDir+k.getOrientation()+".mp4");var i,n;if(void 0!==PiecSettings.videoFramerate){var a=PiecSettings.videoFramerate;i=C.convertFrameToSeconds(this.currentState.from,a),n=C.convertFrameToSeconds(this.currentState.to,a)}else i=this.currentState.from,n=this.currentState.to;console.log("FROM "+i+", TO "+n),this.videoController.play(t,{from:i,to:n,loop:this.currentState.loop}),this.currentStateHasAutoplayTimer()&&this.currentState.loop&&this.setAutoPlayTimer(this.currentState.autoplay),this.currentStateHasDirectAutoplay()&&this.currentStateHasTimer()&&this.setVideoPlayableTimer(),void 0!==this.currentState.revealCloseButton&&1==this.currentState.revealCloseButton&&parent.postMessage("revealCloseButton","*"),void 0!==this.currentState.complete&&void 0!==this.currentState.completeDelay&&this.game.time.events.add(this.currentState.completeDelay,function(){parent.postMessage("complete","*"),console.log("complete")},this)}}},{key:"getCurrentStateEarliestInteractionTime",value:function(){var e=1e3;if(void 0!==this.currentState.interactions&&null!=this.currentState.interactions)for(var t=0;t<this.currentState.interactions.length;t++)this.currentState.interactions[t].from<e&&(e=this.currentState.interactions[t].from);else e=this.currentState.from;return e}},{key:"getCurrentStateLatestInteractionTime",value:function(){var e=this.currentState.to;if(void 0!==this.currentState.interactions&&null!=this.currentState.interactions)for(var t=0;t<this.currentState.interactions.length;t++)void 0!==this.currentState.interactions[t].to&&this.currentState.interactions[t].to>e&&(e=this.currentState.interactions[t].to);return e}},{key:"getCurrentStateTimerDuration",value:function(){return this.currentStateHasAutoplayTimer()?this.currentState.autoplay.after/1e3:this.getCurrentStateLatestInteractionTime()-this.getCurrentStateEarliestInteractionTime()}},{key:"currentStateHasTimer",value:function(){return void 0!==this.currentState.autoplay&&void 0!==this.currentState.autoplay.timer&&this.currentState.autoplay.timer}},{key:"currentStateHasDirectAutoplay",value:function(){return void 0!==this.currentState.autoplay&&void 0!==this.currentState.autoplay.script}},{key:"currentStateHasAutoplayTimer",value:function(){return void 0!==this.currentState.autoplay&&void 0!==this.currentState.autoplay.script&&void 0!==this.currentState.autoplay.after}},{key:"currentStateHasEnabledInteractions",value:function(){return this.interactiveElementsController.areThereEnabledInteractions(void 0!==this.currentState.to?this.currentState.to:1e7,this.videoPlayableVariablesController,this.currentState.interactions)}},{key:"currentStateIsTheEnd",value:function(){return!this.currentStateHasDirectAutoplay()&&(void 0==this.currentState.interactions||0==this.currentState.interactions.length||void 0!==this.currentState.interactions&&!this.currentStateHasEnabledInteractions())}},{key:"autoplay",value:function(){this.transitionToState(this.currentState.autoplay.script)}},{key:"playAudio",value:function(){this.videoPlayableAudioController.enableAudio()}},{key:"pause",value:function(){this.paused=!0,this.videoPlayableAudioController.pauseAllAudio(),this.videoController.pause()}},{key:"resume",value:function(){this.paused=!1,this.videoPlayableAudioController.unmuteAllAudio(),void 0!=this.autoplayTimer&&this.game.time.events.remove(this.autoplayTimer),this.transitionToState(this.currentState.keyName)}},{key:"setAutoPlayTimer",value:function(e){var t=this.currentState;this.autoplayTimer=this.game.time.events.add(e.after,function(){console.log("AUTOPLAY TRIGGERED"),this.currentState==t&&this.autoplay()},this)}},{key:"setVideoPlayableTimer",value:function(){if(null!=this.videoPlayableTimer){var e=this.getCurrentStateTimerDuration(),t=this.getCurrentStateEarliestInteractionTime()-this.videoController.getCurrentTime();this.videoPlayableTimer.startTimer(1e3*t,e)}}}]),e}();i.default=x},{"../prefabs/video-controller":20,"../prefabs/video-playable-audio-controller":21,"../prefabs/video-playable-collectible-controller":22,"../prefabs/video-playable-hud-controller":23,"../prefabs/video-playable-interactive-elements-controller":24,"../prefabs/video-playable-timer":26,"../prefabs/video-playable-variables-controller":27,"../utils/util.js":36,"../utils/video-playable-util":37}],26:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=e("../prefabs/counter"),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=e("../utils/tweener"),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}(u),h=function(e){function t(e){n(this,t);var i=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i.timerHud=new l.default(i.game,{tag:"video-playable-timer",htmlTag:"video-playable-timer",backgroundSrc:"timer",style:"circle_progressbar",initialValue:100,maxValue:100,minValue:0}),i.add(i.timerHud),i.initialScale=i.timerHud.scale.x,i.enabled=!1,i.lastXSeconds=1,i.timerHud.alpha=0,i.game.time.events.loop(Phaser.Timer.SECOND/100,i.updateTimer,i),i}return o(t,e),r(t,[{key:"startTimer",value:function(e,t){this.resetTimer(),this.popIn(e),this.game.time.events.add(e,function(){this.enabled=!0,this.startTime=new Date,this.countdownTime=t,this.elapsedTime=0},this)}},{key:"resetTimer",value:function(){this.pulsating=!1}},{key:"stopTimer",value:function(){this.popOut(),this.enabled=!1}},{key:"updateTimer",value:function(){if(this.elapsedTime<this.countdownTime&&this.enabled){var e=new Date,t=this.startTime.getTime()-e.getTime();this.elapsedTime=Math.abs(t/1e3);var i=this.countdownTime-this.elapsedTime;i>0&&this.timerHud.setCircleBarTo(this.getCompletionValue(i)),i<2*this.lastXSeconds&&(this.pulsating||this.pulsate(this.lastXSeconds)),i<=0&&this.stopTimer()}}},{key:"getCompletionValue",value:function(e){return e>2*this.lastXSeconds?(e-this.lastXSeconds)/(this.countdownTime-this.lastXSeconds)*100:e/(2*(this.countdownTime-this.lastXSeconds))*100}},{key:"popIn",value:function(e){this.game.time.events.add(Math.max(0,e-500),function(){this.timerHud.setCircleBarTo(105),this.removeTween(),this.restartScale(),this.tween=c.scaleIn(this.timerHud,0,500,Phaser.Easing.Elastic.Out),this.timerHud.alpha=1},this)}},{key:"popOut",value:function(){this.removeTween(),this.tween=c.scaleOut(this.timerHud,0,500,Phaser.Easing.Elastic.In)}},{key:"pulsate",value:function(e){this.removeTween(),this.restartScale(),this.pulsating=!0,this.tween=this.game.add.tween(this.timerHud.scale).to({x:1.1,y:1.1},500,Phaser.Easing.Quadratic.InOut,!0,0).repeat(e).yoyo(!0)}},{key:"restartScale",value:function(){this.timerHud.scale.x=this.initialScale,this.timerHud.scale.y=this.initialScale}},{key:"removeTween",value:function(){this.tween&&this.game.tweens.remove(this.tween)}}]),t}(Phaser.Group);i.default=h},{"../prefabs/counter":8,"../utils/tweener":35}],27:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=function(){function e(t){n(this,e),this.variables=[];for(var i in t)this.variables[i]=t[i].value;this.initSignals()}return a(e,[{key:"initSignals",value:function(){this.onVariableUpdate=new Phaser.Signal}},{key:"applyConsequences",value:function(e){if(void 0!==e){for(var t=e.split(";"),i=0;i<t.length;i++){var n=t[i],a="";if(n.includes("--"))this.decreaseVariable(n.split("--")[0],1),a=n.split("--")[0];else if(n.includes("-="))this.decreaseVariable(n.split("-=")[0],parseFloat(n.split("-=")[1])),a=n.split("-=")[0];else if(n.includes("++"))this.increaseVariable(n.split("++")[0],1),a=n.split("++")[0];else if(n.includes("+="))this.increaseVariable(n.split("+=")[0],parseFloat(n.split("+=")[1])),a=n.split("+=")[0];else if(n.includes("=")){var o=n.split("=")[1];this.setVariable(n.split("=")[0],isNaN(o)?o:parseFloat(o)),a=n.split("=")[0]}this.onVariableUpdate.dispatch(a,this.variables[a])}console.log(this.variables)}}},{key:"increaseVariable",value:function(e,t){null!=this.variables[e]&&(this.variables[e]+=t)}},{key:"decreaseVariable",value:function(e,t){null!=this.variables[e]&&(this.variables[e]-=t)}},{key:"setVariable",value:function(e,t){null!=this.variables[e]&&(this.variables[e]=t)}},{key:"evaluateConditions",value:function(e){var t=!0;if(void 0!==e)for(var i=e.split("&&"),n=0;n<i.length;n++){var a=i[n];if(a.includes("==")){var o=a.split("==")[1];t&=this.variableEqualTo(a.split("==")[0],isNaN(o)?o:parseFloat(o))}else if(a.includes("!=")){var o=a.split("!=")[1];t&=this.variableDifferentThan(a.split("!=")[0],isNaN(o)?o:parseFloat(o))}else if(a.includes(">=")){var o=a.split(">=")[1],r=this.variableBiggerThanOrEqualTo(a.split(">=")[0],isNaN(o)?o:parseFloat(o));t&=r}else if(a.includes("<=")){var o=a.split("<=")[1];t&=this.variableSmallerThanOrEqualTo(a.split("<=")[0],isNaN(o)?o:parseFloat(o))}else if(a.includes(">")){var o=a.split(">")[1];t&=this.variableBiggerThan(a.split(">")[0],isNaN(o)?o:parseFloat(o))}else if(a.includes("<")){var o=a.split("<")[1];t&=this.variableSmallerThan(a.split("<")[0],isNaN(o)?o:parseFloat(o))}else console.log("Operator not supported! "+a)}return t}},{key:"variableBiggerThan",value:function(e,t){return this.variables[e]>t}},{key:"variableBiggerThanOrEqualTo",value:function(e,t){return this.variables[e]>=t}},{key:"variableSmallerThan",value:function(e,t){return this.variables[e]<t}},{key:"variableSmallerThanOrEqualTo",value:function(e,t){return this.variables[e]<=t}},{key:"variableEqualTo",value:function(e,t){return this.variables[e].toString()==t.toString()}},{key:"variableDifferentThan",value:function(e,t){return this.variables[e].toString()!=t.toString()}}]),e}();i.default=o},{}],28:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}
}(),s=function(e){function t(){return n(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return o(t,e),r(t,[{key:"preload",value:function(){}},{key:"init",value:function(){PiecSettings.assetsDir="dev"===PiecSettings.env?"assets/":"";var e=this.game;e.onInteract=new Phaser.Signal,e.onSDKCall=new Phaser.Signal,e.onResize=new Phaser.Signal,"undefined"!=typeof piec&&(piec.lockGame=function(){e.global.locked=!0},piec.unlockGame=function(){e.global.locked=!1},piec.destroyGame=function(){e.destroy()},piec.onSDKCall=function(){e.onSDKCall.dispatch()},piec.onResize=function(){e.onResize.dispatch()}),window.onresize=function(){e.scale.setGameSize(document.body.clientWidth*window.devicePixelRatio,document.body.clientHeight*window.devicePixelRatio),e.scale.refresh(),e.state.start("boot",!0,!1)}}},{key:"create",value:function(){this.init(),this.game.input.maxPointers=1,this.initGlobalVariables(),this.game.state.start("preloader"),this.game.onMoveStart=function(e){e.global.interactions++,PiecSettings&&PiecSettings.onMoveStart&&PiecSettings.onMoveStart(e.global.interactions)},this.game.onMoveComplete=function(e){PiecSettings&&PiecSettings.onMoveComplete&&PiecSettings.onMoveComplete(e.global.moveStats)}}},{key:"initGlobalVariables",value:function(){this.game.global={interaction:0,gameComplete:!1,currentVideoScript:null}}}]),t}(Phaser.State);i.default=s},{}],29:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e("../prefabs/orientation-locker"),u=n(l),c=e("../prefabs/video-playable-state-controller"),h=n(c),d=function(e){function t(){return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return r(t,e),s(t,[{key:"create",value:function(){this.game.scale.scaleMode=Phaser.ScaleManager.USER_SCALE,this.game.scale.setUserScale(1/window.devicePixelRatio,1/window.devicePixelRatio,0,0),this.game.global.windowWidth=document.body.clientWidth*window.devicePixelRatio,this.game.global.windowHeight=document.body.clientHeight*window.devicePixelRatio,this.orientationLock(),this.game.onResize.add(this.resize,this),this.game.stage.disableVisibilityChange=!0,this.videoPlayableStateController=new h.default(this.game,"videoBg",PiecSettings.script[PiecSettings.initialScript],PiecSettings.script,PiecSettings.variables),this.videoPlayableStateController.transitionToState(PiecSettings.initialScript),this.setupController(),this.initSDKListeners()}},{key:"initSDKListeners",value:function(){var e=this;window.addEventListener("ad-event-pause",function(){e.pause()}),window.addEventListener("ad-event-resume",function(){e.resume()})}},{key:"setupController",value:function(){this.videoPlayableStateController.onPlayableComplete.add(function(){this.gameCompleteFired||(this.onGameComplete(),this.gameCompleteFired=!0)},this)}},{key:"resize",value:function(){null!=this.orientationLocker&&this.orientationLocker.update()}},{key:"render",value:function(){}},{key:"update",value:function(){this.videoPlayableStateController.update()}},{key:"pause",value:function(){this.videoPlayableStateController.pause()}},{key:"resume",value:function(){this.videoPlayableStateController.resume()}},{key:"onGameComplete",value:function(){void 0!==PiecSettings.asoiTimer?this.game.time.events.add(PiecSettings.asoiTimer,function(){console.log("COMPLETE AFTER ASOITIMER"),parent.postMessage("complete","*")},this):(console.log("COMPLETE"),parent.postMessage("complete","*"))}},{key:"orientationLock",value:function(){var e=void 0!==PiecSettings.orientationLock?PiecSettings.orientationLock:"none",t=void 0!==PiecSettings.videoOrientation?PiecSettings.videoOrientation:"none";this.orientationLocker=new u.default(this.game,t,e),this.orientationLocker.update()}}]),t}(Phaser.State);i.default=d},{"../prefabs/orientation-locker":15,"../prefabs/video-playable-state-controller":25}],30:[function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),l=e("../atlas/index"),u=(n(l),e("../utils/util")),c=n(u),h=e("../utils/custom-png-sequences-renderer.js"),d=n(h),f=function(e){function t(){a(this,t);var e=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.preloadAsset=!1,e.ready=!1,e}return r(t,e),s(t,[{key:"preload",value:function(){this.load.onLoadComplete.addOnce(this.onLoadComplete,this),this.loadResources()}},{key:"update",value:function(){this.ready&&this.game.state.start("endcard")}},{key:"loadResources",value:function(){this.loadInteractionImages(),this.loadCollectiblesImages(),this.loadHudElements(),this.loadMiniGamesImages(),d.preloadPngSequences(this.game),this.preloadAsset||this.onLoadComplete()}},{key:"loadInteractionImages",value:function(){for(var e in PiecSettings.script)if(PiecSettings.script.hasOwnProperty(e)){var t=PiecSettings.script[e];if(void 0!==t.interactions)for(var i=0;i<t.interactions.length;i++)void 0!==t.interactions[i].src&&""!=t.interactions[i].src&&(this.game.load.image(t.interactions[i].src,PiecSettings.assetsDir+t.interactions[i].src),this.preloadAsset=!0);void 0!==t.autoplay&&void 0!==t.autoplay.timer&&t.autoplay.timer&&(this.game.load.image("timer",PiecSettings.assetsDir+"timer.png"),this.game.load.image("timer-fill",PiecSettings.assetsDir+"timer_fill.png"),this.preloadAsset=!0)}}},{key:"loadCollectiblesImages",value:function(){var e=0;if(void 0!==PiecSettings.collectibles)for(var t in PiecSettings.collectibles)if(PiecSettings.collectibles.hasOwnProperty(t)){e++;var i=PiecSettings.collectibles[t];this.game.load.image(i.src,PiecSettings.assetsDir+i.src),this.loadCounterImages(i.counter)}e>0&&(this.game.load.image("cloud",PiecSettings.assetsDir+"cloud.png"),this.preloadAsset=!0)}},{key:"loadHudElements",value:function(){if(void 0!==PiecSettings.hudElements)for(var e in PiecSettings.hudElements)if(PiecSettings.hudElements.hasOwnProperty(e)){var t=PiecSettings.hudElements[e];if(void 0!==t.src&&""!=t.src){var i="";void 0!==t.OSsensitive&&1==t.OSsensitive&&(i=c.getDeviceOS()+"-"),this.game.load.image(i+t.src,PiecSettings.assetsDir+i+t.src),this.preloadAsset=!0}}}},{key:"loadMiniGamesImages",value:function(){if(void 0!==PiecSettings.minigames)for(var e in PiecSettings.minigames)if(PiecSettings.minigames.hasOwnProperty(e)){var t=PiecSettings.minigames[e];if(void 0!==t.src&&""!=t.src&&-1!=t.src.indexOf(".png")&&(this.game.load.image(t.src,PiecSettings.assetsDir+t.src),this.preloadAsset=!0),void 0!==t.objects&&t.objects.length>0)for(var i=0;i<t.objects.length;i++){var n=t.objects[i];-1!=n.src.indexOf(".png")&&(this.game.load.image(n.src,PiecSettings.assetsDir+n.src),this.preloadAsset=!0),void 0!==n.shadowSrc&&""!=n.shadowSrc&&(this.game.load.image(n.shadowSrc,PiecSettings.assetsDir+n.shadowSrc),this.preloadAsset=!0)}if(void 0!==t.particles&&void 0!==t.particles.src)for(var i=0;i<t.particles.src.length;i++)-1!=t.particles.src[i].indexOf(".png")&&(this.game.load.image(t.particles.src[i],PiecSettings.assetsDir+t.particles.src[i]),this.preloadAsset=!0);void 0!==t.followFinger&&void 0!==t.followFinger.src&&-1!=t.followFinger.src.indexOf(".png")&&(this.game.load.image(t.followFinger.src,PiecSettings.assetsDir+t.followFinger.src),this.preloadAsset=!0),this.loadCounterImages(t.counter)}}},{key:"loadCounterImages",value:function(e){void 0!==e&&(void 0!==e.iconSrc&&""!=e.iconSrc&&(this.game.load.image(e.iconSrc,PiecSettings.assetsDir+e.iconSrc),this.preloadAsset=!0),void 0!==e.backgroundSrc&&""!=e.backgroundSrc&&(this.game.load.image(e.backgroundSrc,PiecSettings.assetsDir+e.backgroundSrc),this.preloadAsset=!0),void 0!==e.fillSrc&&""!=e.fillSrc&&(this.game.load.image(e.backgroundSrc+"-fill",PiecSettings.assetsDir+e.fillSrc),this.preloadAsset=!0))}},{key:"onLoadComplete",value:function(){this.ready=!0}}]),t}(Phaser.State);i.default=f},{"../atlas/index":1,"../utils/custom-png-sequences-renderer.js":33,"../utils/util":36}],31:[function(e,t,i){"use strict";function n(e,t){e.loopReverse&&(e.animations.currentAnim.isReversed=!0),0!=t.loopCount&&t.loopCount==e.numberOfLoops&&(e.persistent||(e.alpha=0,t.loop=!1))}function a(e,t,i,n,a,s){if(t.loopReverse=a,t.speed=n,t.loopReverse)e.time.events.add(i,function(){t.alpha=1,t.animations.play("animation",n,!1),t.animations.currentAnim.onComplete.add(o,this)});else{var l=void 0!==s||s>=0;e.time.events.add(i,function(){t.alpha=1,t.animations.play("animation",n,l),l||t.animations.currentAnim.onComplete.add(r,this)})}}function o(e,t){e.animations.currentAnim.isReversed=!e.animations.currentAnim.isReversed,e.animations.play("animation",e.speed,!1)}function r(e,t){e.persistent||(e.alpha=0)}function s(e,t,i,o,r,s,l,u,c,h,d,f){for(var g=h.offsetWidth*window.devicePixelRatio,p=h.offsetHeight*window.devicePixelRatio,m=h.offsetLeft*window.devicePixelRatio,v=h.offsetTop*window.devicePixelRatio,y=g/100,b=p/100,w=[],P=0;P<t.length;P++){var C=d.add.sprite(m+t[P]*y,v+i[P]*b,e);f.add(C),C.anchor.set(s),C.animations.add("animation"),C.alpha=0,C.persistent=c,a(d,C,o[P],l,!1,r[P]),C.scale.x=g*u[P]/100/C.width,C.scale.y=C.scale.x,w.push(C),null!=r&&(C.numberOfLoops=r[P],C.animations.currentAnim.onLoop.add(n,this))}return w}function l(e,t,i,n,a,o){var r=t.scale.x;t.scale.x=.01,t.scale.y=.01,e.time.events.add(n,function(){e.add.tween(t.scale).to({x:r,y:r},i,Phaser.Easing.Back.Out,!0,0).onComplete.add(function(){e.time.events.add(a,function(){e.add.tween(t).to({alpha:0},i,Phaser.Easing.Quadratic.In,!0,0).onComplete.add(function(){t.destroy()},this)},this)},this)},this)}function u(e,t,i,n,a,o,r,s){e.time.events.add(r,function(){t.alpha=1,e.add.tween(t).to({y:n,x:i},o,s,!0,0),e.add.tween(t.scale).to({x:a,y:a},o,s,!0,0)},this),e.time.events.add(9e3+r,function(){e.add.tween(t).to({alpha:0},1e3,Phaser.Easing.Quadratic.InOut,!0,0),e.time.events.add(1e3,function(){t.destroy()},this)},this)}function c(e,t,i,n,a,o,r,s){e.time.events.add(r,function(){t.alpha=0,e.add.tween(t).to({alpha:[.5,1,0],y:n,x:i,angle:180},o,s,!0,0),e.add.tween(t.scale).to({x:a,y:a},o,s,!0,0)},this)}function h(e,t,i,n,a,o,r){this.starFloatWithDelayCustom(e,t,i,n,a,o,r,Phaser.Easing.Quadratic.Out)}function d(e,t,i,n,a,o){for(var r=Math.random()>.5?1:-1,s=50*Math.random()+30,l=0;l<20;l++){var u=new Phaser.Sprite(game,0,0,t);u.x=e.x,u.y=e.y,u.scale.x=e.x/1.5/u.width,u.scale.y=u.scale.x,u.alpha=0,u.anchor.set(.5);var c=u.scale.x,h=a+200*Math.random(),d=20*l+o,f=u.x;game.add.tween(u).to({x:[f+Math.random()*s*r,this.goal.getXCoordOfGoal(index)-Math.random()*s*r,this.goal.getXCoordOfGoal(index)],y:this.goal.getYCoordOfGoal(index),alpha:[1,1,1,1,0]},h,Phaser.Easing.Quadratic.InOut,!0,d).interpolation(function(e,t){return Phaser.Math.catmullRomInterpolation(e,t)}).onComplete.add(function(e){e.destroy()},this),game.add.tween(u.scale).to({x:[1.1*c,c,c,.5*c],y:[1.1*c,c,c,.5*c]},h,Phaser.Easing.Quadratic.InOut,!0,d),this.fxLayer.add(u)}}Object.defineProperty(i,"__esModule",{value:!0}),i.onLoop=n,i.playAnimation=a,i.onComplete=o,i.onCompleteNoLooping=r,i.playAnimations=s,i.spawnAndDissapear=l,i.starFloatWithDelayCustom2=u,i.starFloatWithDelayCustom=c,i.starFloatWithDelay=h,i.flyBubbleToGoal=d},{}],32:[function(e,t,i){"use strict";function n(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;a(t);var o=document.getElementById(t),r=o.offsetWidth*window.devicePixelRatio,s=o.offsetHeight*window.devicePixelRatio,l=o.getBoundingClientRect().left*window.devicePixelRatio,u=o.getBoundingClientRect().top*window.devicePixelRatio;void 0!==e.anchor&&(e.anchor.x=i,e.anchor.y=n),e.x=l+r*i,e.y=u+s*n;var c=e.scale.x;e.scale.x=r/(e.width/e.scale.x),e.scale.y=e.scale.x,e.height>s&&(e.scale.x=c,e.scale.y=c,e.scale.y=s/(e.height/e.scale.y),e.scale.x=e.scale.y)}function a(e){null==document.getElementById(e)&&console.log("ERROR: Container Name "+e+" doesn't exist in the DOM")}function o(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;a(t);var o=document.getElementById(t),r=o.offsetWidth*window.devicePixelRatio,s=o.offsetHeight*window.devicePixelRatio,l=o.getBoundingClientRect().left*window.devicePixelRatio,u=o.getBoundingClientRect().top*window.devicePixelRatio;void 0!==e.anchor&&(e.anchor.x=i,e.anchor.y=n),e.x=l+r*i,e.y=u+s*n,e.scale.x=r/(e.width/e.scale.x),e.scale.y=e.scale.x}function r(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;a(t);var o=document.getElementById(t),r=o.offsetWidth*window.devicePixelRatio,s=o.offsetHeight*window.devicePixelRatio,l=o.getBoundingClientRect().left*window.devicePixelRatio,u=o.getBoundingClientRect().top*window.devicePixelRatio;void 0!=e.anchor&&e.anchor.set(i,n),e.x=l+r*i,e.y=u+s*n,e.scale.y=s/e.height,e.scale.x=e.scale.y}function s(e,t){o(e,t),e.x+=e.width/2,e.y+=e.height/2}function l(e){return a(e),document.getElementById(e).getBoundingClientRect().top*window.devicePixelRatio}function u(e){return a(e),document.getElementById(e).getBoundingClientRect().left*window.devicePixelRatio}function c(e){return a(e),document.getElementById(e).offsetWidth*window.devicePixelRatio}function h(e){return a(e),document.getElementById(e).offsetHeight*window.devicePixelRatio}function d(e,t){a(t);var i=document.getElementById(t),n=i.offsetWidth*window.devicePixelRatio;i.offsetHeight,window.devicePixelRatio;e.scale.x=n/e.width,e.scale.y=e.scale.x}function f(e){a(e);var t=document.getElementById(e),i=t.offsetWidth*window.devicePixelRatio,n=(t.offsetHeight,window.devicePixelRatio,t.getBoundingClientRect().left*window.devicePixelRatio);t.getBoundingClientRect().top,window.devicePixelRatio;return n+Math.random()*i}function g(e){a(e);var t=document.getElementById(e),i=(t.offsetWidth,window.devicePixelRatio,t.offsetHeight*window.devicePixelRatio);t.getBoundingClientRect().left,window.devicePixelRatio;return t.getBoundingClientRect().top*window.devicePixelRatio+Math.random()*i}function p(e){a(e);var t=document.getElementById(e),i=t.offsetWidth*window.devicePixelRatio;return t.getBoundingClientRect().left*window.devicePixelRatio+i/2}function m(e){a(e);var t=document.getElementById(e),i=t.offsetHeight*window.devicePixelRatio;return t.getBoundingClientRect().top*window.devicePixelRatio+i/2}function v(e){var t={};if(t.x=e.global.windowWidth/2,t.y=e.global.windowHeight/2,-90==e.world.angle){var i=t.x;t.x=t.y,t.y=i}return t}function y(e,t,i){var n={};if(n.x=t,n.y=i,-90==e.world.angle){var a=n.x;n.x=n.y,n.y=a}return n}Object.defineProperty(i,"__esModule",{value:!0}),i.bestFit=n,i.fitInContainer=o,i.fitInContainerHeight=r,i.fitInContainerAnchorAtCenter=s,i.getContainerY=l,i.getContainerX=u,i.getContainerWidth=c,i.getContainerHeight=h,i.resizeToSizeOfContainer=d,i.getRandomXWithinContainer=f,i.getRandomYWithinContainer=g,i.getXCenterWithinContainer=p,i.getYCenterWithinContainer=m,i.getWorldCentre=v,i.getWorldPos=y},{}],33:[function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function a(e){if(null!=PiecSettings.pngAnimations)for(var t in PiecSettings.pngAnimations){var i=PiecSettings.pngAnimations[t];o(e,i)}}function o(e,t){var i=t.src.substr(0,t.src.indexOf("."));e.load.spritesheet(i,PiecSettings.assetsDir+t.src,t.spriteWidth,t.spriteHeight,t.spriteNumber)}function r(e,t,i){var n=PiecSettings.pngAnimations[t],a=n.src.substr(0,n.src.indexOf("."));if(null!=n.htmlContainer){var o=document.getElementById(n.htmlContainer),r=o.offsetWidth*window.devicePixelRatio;o.offsetHeight,window.devicePixelRatio,o.getBoundingClientRect().left,window.devicePixelRatio,o.getBoundingClientRect().top,window.devicePixelRatio}var s=e.add.sprite(0,0,a);if(s.animations.add("animation"),s.alpha=0,null==n.loopReverse&&(n.loopReverse=!1),null!=n.isReversed&&n.isReversed&&(s.animations.currentAnim.isReversed=!0),l.playAnimation(e,s,n.delay,n.fps,n.loopReverse,n.loops),null!=n.angle&&0!=n.angle){var u=0;this.game.global.windowWidth>this.game.global.windowHeight&&null!=n.responsiveAngle&&n.responsiveAngle&&(u=90),s.anchor.set(.5),s.angle=n.angle+u}if(void 0!==n.htmlContainer&&(s.scale.x=r/s.width,s.scale.y=s.scale.x,s.persistent=!1),void 0!==n.persistent&&(s.persistent=n.persistent),void 0!==n.loops&&(s.numberOfLoops=n.loops,s.animations.currentAnim.onLoop.add(l.onLoop,this)),void 0!==n.effect&&-1!=n.effect.indexOf("fade-in")){s.alpha=0;e.add.tween(s).to({alpha:1},1e3,Phaser.Easing.Linear.None,!0,n.delay)}return s}Object.defineProperty(i,"__esModule",{value:!0}),i.preloadPngSequences=a,i.playPngSequence=r;var s=e("../utils/animations-util.js"),l=n(s),u=e("../utils/container-util");n(u)},{"../utils/animations-util.js":31,"../utils/container-util":32}],34:[function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t}function a(e,t,i,n,a,o){for(var r=0;r<o;r++){var l=s(e,t);d.fitInContainer(l,i,.5,.5),l.x=n,l.y=a;var u=.1*Math.random()+1;l.scale.x*=u,l.scale.y=l.scale.x;var c=90*Math.random();l.angle=c,e.add.existing(l);var h=100*Math.random(),f=600+200*Math.random(),p=Math.random()-.5,m=l.y-l.height*(3*Math.random()),v=g.moveTo(l,l.x+p*l.width*15,[m,m+l.height*(7*Math.random())],h,f,Phaser.Easing.Quadratic.Out);l.tween=v,e.add.tween(l).to({angle:c+25*p+100*(p<0?-1:1)},f,Phaser.Easing.Quadratic.InOut,!0,h),g.scaleOut(l,f-200,200,Phaser.Easing.Quadratic.InOut),v.onComplete.add(function(e){e.destroy()})}}function o(e,t,i,n,a,o,r){for(var l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:10,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:40,c=0;c<r;c++){var h=s(e,t);d.fitInContainer(h,i,.5,.5),h.x=a,h.y=o;var f=.5*Math.random()+.5;h.scale.x*=f,h.scale.y=h.scale.x;var p=90*Math.random();h.angle=p,e.add.existing(h);var m=100*Math.random(),v=1500+200*Math.random(),y=Math.random()-.5,b=h.y-h.height*(Math.random()*l),w=-1,P=-1;if(void 0!==n&&(w=d.getContainerX(n),P=d.getContainerY(n)),-1!=w&&-1!=P){var C=g.moveTo(h,[h.x+y*h.width*u,h.x+y*h.width*u*5,w+Math.random()*h.width*10],[b,b+h.height*(30*Math.random()),P+Math.random()*h.height*10],m,v,Phaser.Easing.Quadratic.Out).interpolation(function(e,t){return Phaser.Math.bezierInterpolation(e,t)});h.tween=C}else if(l>0){var C=g.moveTo(h,h.x+y*h.width*u,[b,b+h.height*(30*Math.random())],m,v,Phaser.Easing.Quadratic.Out).interpolation(function(e,t){return Phaser.Math.bezierInterpolation(e,t)});h.tween=C}else{var C=g.moveTo(h,h.x+y*h.width*u,b+h.height*(30*Math.random()),m,v,Phaser.Easing.Quadratic.Out).interpolation(function(e,t){return Phaser.Math.bezierInterpolation(e,t)});h.tween=C}e.add.tween(h).to({angle:p+25*y+100*(y<0?-1:1)},v,Phaser.Easing.Quadratic.InOut,!0,m),g.scaleOut(h,v-100,100,Phaser.Easing.Quadratic.InOut),C.onComplete.add(function(e){e.destroy()})}}function r(e,t,i,n,a,o,r,l){for(var u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,c=0;c<o;c++){var h=s(e,t);d.fitInContainer(h,i,.5,.5),h.x=n,h.y=a;var f=.5*Math.random()+1;h.scale.x*=f,h.scale.y=h.scale.x;var p=90*Math.random();h.angle=p,e.add.existing(h);var m=100*Math.random(),v=600+200*Math.random(),y=g.moveTo(h,h.x+r*h.width*(Math.random()+u),h.y+l*h.height*(Math.random()+u),m,v,Phaser.Easing.Quadratic.Out);h.tween=y,e.add.tween(h).to({angle:p+25*r+100*(r<0?-1:1)},v,Phaser.Easing.Quadratic.InOut,!0,m);var b=h.scale.x;h.scale.x=.2*b,h.scale.y=.2*b,e.add.tween(h.scale).to({x:[b,b,b,.01],y:[b,b,b,.01]},v,Phaser.Easing.Quadratic.InOut,!0,0),y.onComplete.add(function(e){e.destroy()})}}function s(e,t){var i=t[Math.min(Math.floor(Math.random()*t.length),t.length-1)];return-1!=i.indexOf(".png")?new Phaser.Sprite(e,0,0,i):m.playPngSequence(e,i,null)}function l(e,t,i,n,a,o){for(var r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:360,s=[],l=0;l<o;l++){var u=c(e,t,i,n,a,r);s.push(u)}return s}function u(e,t,i,n,a,o,r){for(var l=(arguments.length>7&&void 0!==arguments[7]&&arguments[7],[]),u=d.getContainerWidth(n)/2,c=0,h=2*Math.PI/r,f=0;f<r;f++){var g=s(e,t);d.fitInContainer(g,i,.5,.5),g.angle=90+360/r*f,l.push(g),e.add.existing(g),g.x=a,g.y=o;var p=g.scale.x,m=g.x+u*Math.cos(c),v=g.y+u*Math.sin(c);c+=h,e.add.tween(g).to({x:m,y:v},400,Phaser.Easing.Quadratic.Out,!0,0),g.scale.x=.1*p,e.add.tween(g.scale).to({x:[p,0],y:[p,0]},400,Phaser.Easing.Quadratic.Out,!0,0)}return l}function c(e,t,i,n,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:360,r=s(e,t),l=Math.random()-.5,u=Math.random()-.5;d.fitInContainer(r,i,.5,.5),r.x=n+l*r.width,r.y=a+u*r.width;var c=.1*Math.random()+1;r.scale.x*=c,r.scale.y=r.scale.x;var h=Math.random()*o;return r.angle=h,e.add.existing(r),r}Object.defineProperty(i,"__esModule",{value:!0}),i.particleBurst=a,i.particleRain=o,i.particleShoot=r,i.particleSpawn=l,i.particleExplosion=u;var h=e("../utils/container-util"),d=n(h),f=e("../utils/tweener"),g=n(f),p=e("../utils/custom-png-sequences-renderer"),m=n(p)},{"../utils/container-util":32,"../utils/custom-png-sequences-renderer":33,"../utils/tweener":35}],35:[function(e,t,i){"use strict";function n(e,t,i,n,a,o,r){var s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(null==e||null===e.game)return null;var l=document.getElementById(t),u=l.offsetWidth*window.devicePixelRatio,c=u*e.anchor.x,h=l.getBoundingClientRect().left*window.devicePixelRatio+c,d=u/(e.width/e.scale.x),f=l.offsetHeight*window.devicePixelRatio,g=f*e.anchor.y,p=l.getBoundingClientRect().top*window.devicePixelRatio+g;s&&e.height/e.scale.y*d>f&&(d=f/(e.height/e.scale.y));var m=e.game.add.tween(e).to({x:h,y:p},n,a,void 0===r||r,i);return e.game.add.tween(e.scale).to({x:d,y:d},n,a,void 0===r||r,i),o&&m.onComplete.add(o,this),m}function a(e,t,i,n,a,o,r,s){if(null===e||null===e.game)return null;var l=e.game.add.tween(e).to({x:t,y:i},a,o,void 0===s||s,n);return r&&l.onComplete.add(r,this),l}function o(e,t,i,n,a,o,r){if(null===e||null===e.game)return null;var s={};null!==t&&(s={alpha:t});var l=e.game.add.tween(e).to(s,0===n?1:n,a,void 0===o||o,i);return r&&l.onComplete.add(r,this),l}function r(e,t,i,n,a,o){return this.fade(e,1,t,i,n,a,o)}function s(e,t,i,n,a,o){return this.fade(e,0,t,i,n,a,o)}function l(e,t,i,n,a,o,r){if(null===e||null===e.game)return null;var s=e.game.add.tween(e.scale).to({x:t,y:i},a,o,!0,n);return r&&s.onComplete.add(r,this),s}function u(e,t,i,n,a,o){if(null===e||null===e.game)return null;var r=document.getElementById(t),s=r.getBoundingClientRect(),l=this.getScaleFromDom(t,e);this.moveTo(e,(s.left+.5*s.width)*window.devicePixelRatio,(s.top+.5*s.height)*window.devicePixelRatio,i,n,a,o),this.scaleTo(e,l,l,i,n,a)}function c(e,t){var i=document.getElementById(e),n=i.getBoundingClientRect(),a=n.width*window.devicePixelRatio/t._frame.width;return!1==t._frame.height*a<=n.height*window.devicePixelRatio&&(a=n.height*window.devicePixelRatio/t._frame.height),a}function h(e,t,i){if(null===e||null===e.game)return null;e.game.add.tween(e.scale).to({x:1.2*e.scale.x,y:1.2*e.scale.x},i,Phaser.Easing.Quadratic.InOut,!0,t,-1,!0)}function d(e,t,i){if(null===e||null===e.game)return null;var n=e.scale.x,a=e.scale.y;e.angle=0,e.scale.x=0,e.scale.y=0,e.game.add.tween(e.scale).to({x:n,y:a},i,Phaser.Easing.Quadratic.InOut,!0,t),e.game.add.tween(e).to({angle:360},i,Phaser.Easing.Back.InOut,!0,t)}function f(e,t,i,n,a){if(null===e||null===e.game)return null;i=e.scale.x*i,n=e.scale.x*n;var o=e.game.add.tween(e.scale).to({x:i,y:i},500,Phaser.Easing.Quadratic.Out,!0,0),r=e.game.add.tween(e.scale).to({x:n,y:n},500,Phaser.Easing.Quadratic.In,!1,0);o.chain(r);var s=e.game.add.tween(e).to({angle:15},500,function(e){return Math.sin(2*Math.PI*e)},!0,0,1);a&&s.onComplete.add(function(){a(e)},this)}function g(e,t,i,n){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=e.scale.x,r=e.scale.y;e.game.add.tween(e.scale).to({x:o*(t||1.1),y:r*(i||.9)},n||800,Phaser.Easing.Linear.None,!0,delay,-1).yoyo(a,0)}function p(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments[4],o=arguments[5];t=t||10;var r=e.angle,s=r+t;e.angle-=t,null!=a&&(e.anchor.x=a),null!=o&&(e.anchor.y=o),e.game.add.tween(e).to({angle:s},i,Phaser.Easing.Linear.None,!0,n,-1).yoyo(!0,0)}function m(e,t,i,n,a){var o=e.scale.x,r=e.scale.y;e.scale.x=.001,e.scale.y=.001,"function"==typeof e.show?e.show():e.alpha=1;var s=e.game.add.tween(e.scale).to({x:o,y:r},i||800,n,!0,t||0);return a&&s.onComplete.add(function(){a(e)},this),s}function v(e,t,i,n,a){var o=e.scale.x,r=e.game.add.tween(e.scale).to({x:.001,y:.001},i||800,n,!0,t||0);return a?r.onComplete.add(function(){"function"==typeof e.hide?e.hide():e.alpha=0,e.scale.x=o,e.scale.y=o,a(e)},this):r.onComplete.add(function(){"function"==typeof e.hide?e.hide():e.alpha=0,e.scale.x=o,e.scale.y=o},this),r}function y(e,t,i,n,a){var o=.3*a;e.alpha=0;var r=e.game.add.tween(e).to({alpha:1},o,Phaser.Easing.Linear.None,!0,n||0),s=e.game.add.tween(e).to({alpha:0},o,Phaser.Easing.Linear.None,!1,a-2*o);r.chain(s),e.game.add.tween(e).to({x:t,y:i},a,Phaser.Easing.Quadratic.Out,!0,n||0)}function b(e,t,i){var n=.3*i,a=.15*i,o=e.scale.x,r=e.scale.y;e.scale.x=0,e.scale.y=0,e.game.add.tween(e.scale).to({x:o,y:r},a,Phaser.Easing.Quadratic.In,!0,t||0),e.game.add.tween(e).to({alpha:0},n,Phaser.Easing.Linear.None,!0,i-a)}function w(e,t,i,n){e.game.add.tween(e).to({angle:[-5,-5,0]},i,n,!0,t);var a=e.scale.x;return e.game.add.tween(e.scale).to({x:[.9*a,.9*a,a],y:[.9*a,.9*a,a]},i,n,!0,t)}function P(e,t,i,n,a){e.angle=t,e.game.add.tween(e).to({angle:[t+10,t+5,t-5,t-5,t]},n,a,!0,i);var o=e.scale.x;return e.game.add.tween(e.scale).to({x:[o,o,.9*o,.9*o,o],y:[o,o,.9*o,.9*o,o]},n,a,!0,i)}function C(e,t,i,n){e.game.add.tween(e).to({angle:-10},i,n,!0,t);var a=e.scale.x;return e.game.add.tween(e.scale).to({x:[1.05*a,.9*a],y:[1.05*a,.9*a]},i,n,!0,t)}function S(e,t,i,n){var a,o,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"up",l=e.y,u=e.x,c=e.scale.x,h=20,d=0;switch(s){case"up":a=.1*e.width,o=1.2*e.height*-1,d=-20,h=-10;break;case"down":a=.1*e.width,o=1.2*e.height,d=20,h=-10;break;case"left":a=1.2*e.width*-1,o=.1*e.height,d=20,h=20;break;case"right":a=1.2*e.width,o=.1*e.height,d=-20;break;case"upleft":a=1.2*e.width*-1,o=1.2*e.height*-1,d=20,h=40;break;case"upright":a=1.2*e.width,o=1.2*e.height*-1,d=-20,h=-20;break;case"downleft":a=1.2*e.width*-1,o=1.2*e.height,d=20,h=-10;break;case"downright":a=1.2*e.width,o=1.2*e.height,d=-15,h=-5}e.game.add.tween(e).to({angle:[h+d,h,h-d],y:[l,l+o/2,l+o],x:[u,u+a/2,u+a]},i,n,!0,t).onComplete.add(function(){e.game.add.tween(e).to({angle:0,x:u,y:l},r-200,n,!0,150)},this),e.game.add.tween(e.scale).to({x:[.8*c,.8*c],y:[.8*c,.8*c]},i,n,!0,t).onComplete.add(function(){e.game.add.tween(e.scale).to({x:c,y:c},150,n,!0,0)},this)}function k(e,t,i,n,a,o,r){var s=n*e.width,l=t,u=i;return e.game.add.tween(e).to({x:[l,l+s*Math.cos(Math.PI/4),l+s,l+s*Math.cos(Math.PI/4),l,l-s*Math.cos(Math.PI/4),l-s,l-s*Math.cos(Math.PI/4),l],y:[u-s,u-s*Math.sin(Math.PI/4),u,u+s*Math.sin(Math.PI/4),u+s,u+s*Math.sin(Math.PI/4),u,u-s*Math.sin(Math.PI/4),u-s],angle:[0,-50,0,50,0]},o,r,!0,a).interpolation(function(e,t){return Phaser.Math.bezierInterpolation(e,t)})}function x(e,t,i,n){var a=.5*e.height,o=e.y,r=e.x,s=e.scale.x;e.game.add.tween(e).to({angle:[10,0,-10],y:[o,o+a/2,o+a],x:[r,r+0,r+0]},i,n,!0,t).onComplete.add(function(){e.game.add.tween(e).to({angle:0,x:r,y:o},i/2,n,!0,500)},this),e.game.add.tween(e.scale).to({x:[.9*s,.9*s],y:[.9*s,.9*s]},i,n,!0,t).onComplete.add(function(){e.game.add.tween(e.scale).to({x:s,y:s},500,n,!0,0)},this)}function O(e,t,i,n){var a=2*e.height*-1;return this.slideIn(e,0,a,t,i,n)}function T(e,t,i,n){var a=2*e.height;return this.slideIn(e,0,a,t,i,n)}function I(e,t,i,n){var a=2*e.width;return this.slideIn(e,a,0,t,i,n)}function E(e,t,i,n){var a=2*e.width*-1;return this.slideIn(e,a,0,t,i,n)}function F(e,t,i,n,a,o){var r=e.x,s=e.y;return e.x+=t,e.y+=i,this.fadeIn(e,n,a/2,Phaser.Easing.Quadratic.InOut),e.game.add.tween(e).to({x:r,y:s},a,o,!0,n)}function _(e,t,i,n){var a=e.scale.x;return e.game.add.tween(e.scale).to({x:1.1*a,y:1.1*a},i,n,!0,t).loop(!0).yoyo(!0)}function M(e,t,i,n){var a=e.scale.x;return e.game.add.tween(e.scale).to({x:1.1*a,y:1.1*a},i,n,!0,t).yoyo(!0)}function R(e,t,i,n){var a=e.scale.x;return e.scale.x=1.1*a,e.scale.y=.9*a,e.game.add.tween(e.scale).to({x:a,y:a},i,n,!0,t)}Object.defineProperty(i,"__esModule",{value:!0}),i.moveToContainer=n,i.moveTo=a,i.fade=o,i.fadeIn=r,i.fadeOut=s,i.scaleTo=l,i.moveToDom=u,i.getScaleFromDom=c,i.bulge=h,i.spinIn=d,i.wobbleScaleIn=f,i.jiggle=g,i.jiggleAngle=p,i.scaleIn=m,i.scaleOut=v,i.fadeFloat=y,i.scaleThenFade=b,i.quickTap=w,i.tap=P,i.tapAndHold=C,i.swipe=S,i.circleAround=k,i.smallSwipeUpDown=x,i.slideInDown=O,i.slideInUp=T,i.slideInLeft=I,i.slideInRight=E,i.slideIn=F,i.pulse=_,i.pulseOnce=M,i.rubberBand=R},{}],36:[function(e,t,i){"use strict";function n(e,t){return t||(t=0),Math.floor(Math.random()*(e-t+1))+t}function a(e){return e[this.rndInt(e.length-1,0)]}function o(e){return e||(e=1),"rgba("+this.rndInt(256)+","+this.rndInt(256)+","+this.rndInt(256)+","+e+")"}function r(){return document.body.clientHeight>document.body.clientWidth}function s(){return r()?"portrait":"landscape"}function l(e){return JSON.parse(JSON.stringify(e))}function u(e,t){var i=e.indexOf(t);i>-1&&e.splice(i,1)}function c(e){return-1===e.lastIndexOf(".")?e:e.substring(0,e.lastIndexOf("."))}function h(e){e.style.opacity=0;var t=+new Date;!function i(){e.style.opacity=+e.style.opacity+(new Date-t)/400,t=+new Date,+e.style.opacity<1&&(window.requestAnimationFrame&&requestAnimationFrame(i)||setTimeout(i,16))}()}function d(e){return 100*Math.sqrt(2*Math.abs(e)/k)}function f(e){var t={boolean:{},number:{},string:{}},i=[];return e.filter(function(e){var n=void 0===e?"undefined":S(e);return n in t?!t[n].hasOwnProperty(e)&&(t[n][e]=!0):!(i.indexOf(e)>=0)&&i.push(e)})}function g(e,t){var i,n={};for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i]);return n}function p(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function m(e,t){
var i=document.getElementById(e),n=i.getBoundingClientRect(),a=n.width*window.devicePixelRatio/t._frame.sourceSizeW;t.scale.x=a,t.scale.y=a,!1==t._frame.sourceSizeH*a<=n.height*window.devicePixelRatio&&(a=n.height*window.devicePixelRatio/t._frame.sourceSizeH,t.scale.x=a,t.scale.y=a),t.anchor.set(.5,.5),t.x=(n.left+.5*n.width)*window.devicePixelRatio,t.y=(n.top+.5*n.height)*window.devicePixelRatio}function v(e,t,i,n){return 180*Math.atan2(n-t,i-e)/Math.PI}function y(e){switch(e){case"Linear":return Phaser.Easing.Linear.None;case"BackIn":return Phaser.Easing.Back.In;case"BackOut":return Phaser.Easing.Back.Out;case"BounceIn":return Phaser.Easing.Bounce.In;case"BounceOut":return Phaser.Easing.Bounce.Out;case"CircularIn":return Phaser.Easing.Circular.In;case"CircularOut":return Phaser.Easing.Circular.Out;case"CubicIn":return Phaser.Easing.Cubic.In;case"CubicOut":return Phaser.Easing.Cubic.Out;case"ElasticIn":return Phaser.Easing.Elastic.In;case"ElasticOut":return Phaser.Easing.Elastic.Out;case"ExponentialIn":return Phaser.Easing.Exponential.In;case"ExponentialOut":return Phaser.Easing.Exponential.Out;case"QuadraticIn":return Phaser.Easing.Quadratic.In;case"QuadraticOut":return Phaser.Easing.Quadratic.Out;case"QuarticIn":return Phaser.Easing.Quartic.In;case"QuarticOut":return Phaser.Easing.Quartic.Out;case"QuinticIn":return Phaser.Easing.Quintic.In;case"QuinticOut":return Phaser.Easing.Quintic.Out;case"SinusoidalIn":return Phaser.Easing.Sinusoidal.In;case"SinusoidalOut":return Phaser.Easing.Sinusoidal.Out}console.error('unkown easing value "'+e+'"')}function b(e,t){for(var i in t)e[i]=t[i];return e}function w(){var e;return navigator.userLanguage?(e=navigator.userLanguage,-1==e.indexOf("zh")&&(e=e.split("-")[0].toLowerCase())):navigator.language?(e=navigator.language,-1==e.indexOf("zh")&&(e=e.split("-")[0].toLowerCase())):(e="en",void 0!==PiecSettings.defaultLang&&(e=PiecSettings.defaultLang)),e=e.toLowerCase(),console.log(e),-1!==e.indexOf("zh")&&(e="zh-tw"==e||"zh-hk"==e?"zh-traditional":"zh"),e}function P(){var e=navigator.userAgent||navigator.vendor||window.opera,t=null;return/windows phone/i.test(e)&&(t="windowsPhone"),/android/i.test(e)&&(t="android"),/iPad|iPhone|iPod/.test(e)&&!window.MSStream&&(t="ios"),t}function C(){return"#"+((1<<24)*(Math.random()+1)|12632256).toString(16).substr(1)}Object.defineProperty(i,"__esModule",{value:!0});var S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};i.rndInt=n,i.sample=a,i.rndRgba=o,i.isPortrait=r,i.getOrientation=s,i.clone=l,i.remove=u,i.removeExtension=c,i.fadeIn=h,i.calcQuadTime=d,i.uniq=f,i.extend=g,i.numberWithCommas=p,i.animToDom=m,i.getAngleBetweenTwoPoints=v,i.getEasing=y,i.JSONmerge=b,i.getDeviceLang=w,i.getDeviceOS=P,i.getRandomColor=C;var k=19.8},{}],37:[function(e,t,i){"use strict";function n(e,t,i){return!(void 0!==e&&i>e)&&(void 0!==t&&i>=t)}function a(e,t){var i=Math.floor(e),n=e%1;return i+Math.round(100*n/t*100)/100}function o(e){if(void 0!==PiecSettings.videoFramerate){e=a(e,PiecSettings.videoFramerate)}return e}Object.defineProperty(i,"__esModule",{value:!0}),i.checkIfShouldBeEnabled=n,i.convertFrameToSeconds=a,i.timeOrFramerateInSeconds=o},{}]},{},[4]);
